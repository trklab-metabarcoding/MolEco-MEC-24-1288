[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Code Resources for MEC-24-1288",
    "section": "",
    "text": "Context\nThis resource contains the code used to generate and analyze data for publication MEC-24-1288.\n\nGlobal availability of plant DNA barcodes as genomic resources to support basic and policy-relevant biodiversity research\nAuthors: Tyler R. Kartzinel 1,2 , Hannah K. Hoff 1,2 , Timothy Divoll 3 , Bethan L. Littleford- Colquhoun 1,2 , Heidi Anderson 4 , Mary K. Burak 1,2 , Maria Kuzmina 5 , Paul M. Musili 6 , Haldre Rogers 7 , Alejandra J. Troncoso 8,9 , Rebecca Y. Kartzinel 1,10 .\n\n\n1 Department of Ecology, Evolution, & Organismal Biology, Brown University, Providence, RI 02912, USA\n\n\n2 Institute at Brown for Environment and Society, Brown University, Providence, RI 02912, USA\n\n\n3 Center for Computation and Visualization, Brown University, Providence, RI 02912, USA\n\n\n4 Yellowstone Center for Resources, Yellowstone National Park, Mammoth Hot Springs, Wyoming, USA\n\n\n5 Centre for Biodiversity Genomics, University of Guelph, Guelph, Ontario, Canada, N1G 2W1\n\n\n6 Botany Department, National Museums of Kenya, Nairobi, Kenya 00100\n\n\n7 Department of Fish and Wildlife Conservation, Virginia Tech, Blacksburg, VA 24061, USA\n\n\n8 Instituto de Ecología y Biodiversidad (IEB), Santiago, Chile\n\n\n9 Departamento de Biología, Universidad de La Serena, La Serena, Chile\n\n\n10 Brown University Herbarium, Brown University, Providence, RI 02912, USA\n\n\nEmail: tyler_kartzinel@brown.edu.\n\n\nData Availability: All data required to complete the analyses are included in Datasets S1-S4 in the Supplement.",
    "crumbs": [
      "Context"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Introduction",
    "section": "",
    "text": "This codebook is divided into four parts that follow the Methods section of the manuscript and includes eight code notebooks that were used in the analyses for this publication.\nSource code is available in a GitHub repository\nSupplementary data sets (S1-S4) can be downloaded from the supplement available with the published paper. Move those four files into the /data folder in the GitHub repository when running the code notebooks.\nIf running notebooks from the repository, headers in the data retrieved may differ than headers in the datasets provided in the Supplemental Materials.\n\n\nBuilding global BOLD data\n\nBuilding the BOLD dataset\n\n\n\nGeographic coverage\n\nCoverage by climatic zones\nCoverage by country\n\n\n\nTaxonomic coverage\n\nFetching data from ITIS\nCorrelations – plant species and available barcodes\n\n\n\nCase-study Yellowstone National Park\n\nContinent-scale barcode coverage of lodgepole pine and big sagebrush\nFetching data from GBIF\nCase-study in geographic coverage of site-based reference data",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "building_bold.html",
    "href": "building_bold.html",
    "title": "Building the BOLD dataset",
    "section": "",
    "text": "Set up directory\nThis notebook queries the BOLD API to fetch all the plant specimen data, including metadata and sequences. We clean as we go to correct for errors in the data on BOLD and adjust for some data being held in private projects on BOLD.\ndir.create(file.path(\"./family_csvs\"))\nsetDTthreads(threads = 6) # if you are working on cluster, this will allow data.table to multithread",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-1-obtain-a-list-of-plant-phyla-in-bold-from-which-to-pull-records",
    "href": "building_bold.html#step-1-obtain-a-list-of-plant-phyla-in-bold-from-which-to-pull-records",
    "title": "Building the BOLD dataset",
    "section": "Step 1: Obtain a list of plant phyla in BOLD from which to pull records",
    "text": "Step 1: Obtain a list of plant phyla in BOLD from which to pull records\n\n# Name BOLD plant phyla\nboldphyla &lt;- c(\"Anthocerotophyta\", \"Bryophyta\", \"Cycadophyta\", \"Ginkgophyta\",  \"Magnoliophyta\", \"Marchantiophyta\", \"Pinophyta\", \"Pteridophyta\", \"Tracheophyta\") #\"Gnetophyta\", \"Psilophyta\", \"Lycopodiophyta\" # these were previously listed a families but are now nested under other families\nlength(boldphyla)",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-2-retrieve-all-families-descending-from-a-vector-of-phyla.",
    "href": "building_bold.html#step-2-retrieve-all-families-descending-from-a-vector-of-phyla.",
    "title": "Building the BOLD dataset",
    "section": "Step 2: retrieve all families descending from a vector of Phyla.",
    "text": "Step 2: retrieve all families descending from a vector of Phyla.\n\nout0 &lt;- vector(\"list\", length(boldphyla))\n\nfor(i in 1:length(boldphyla)){\n    tempx&lt;-taxize::downstream(boldphyla[i], db = \"bold\", downto = \"family\")\n    out0[[i]] &lt;- tempx[[1]]$name\n    }\nboldfamilies &lt;- sort(unlist(out0))\n\n# Remove families that return errors (private entries exist in BOLD so they can be found \"downstream\" of their respective phyla, but don't permit downloads of any barcode data and need to be excluded before the next phase\n\n# As taxonomy gets reclassified, and barcode coverage improves, the families below may need to be updated depending on when this analysis is being run. The families below did not have public records at the time we ran our analysis, but they may as database coverage improves over time\nboldfamilies &lt;- boldfamilies[which(boldfamilies != \"Chonecoleaceae\")]   # in BOLD but nothing public\nboldfamilies &lt;- boldfamilies[which(boldfamilies != \"Cytinaceae\")]   # in BOLD but nothing public \nboldfamilies &lt;- boldfamilies[which(boldfamilies != \"Eropodiaceae\")] # in BOLD but nothing public\nboldfamilies &lt;- boldfamilies[which(boldfamilies != \"Hydnoraceae\")]  # in BOLD but nothing public\nboldfamilies&lt;-boldfamilies[which(boldfamilies != \"Labiatae\")]   # in BOLD but nothing public\nboldfamilies&lt;-boldfamilies[which(boldfamilies != \"Leucobryaceae\")]  # in BOLD but nothing public\nboldfamilies&lt;-boldfamilies[which(boldfamilies != \"Scrophularaceae\")]    # misspelling in BOLD but nothing public\nboldfamilies&lt;-boldfamilies[which(boldfamilies != \"Sterculiaceae\")]  # in BOLD but nothing public\nboldfamilies&lt;-boldfamilies[which(boldfamilies != \"Kahakuloaceae\")]\n# Length of boldfamilies plus those that have no public data (hashed out above) is how many land plant families BOLD recognizes\n\nnopublicrecords &lt;- c(\"Chonecoleaceae\", \"Cytinaceae\", \"Eropodiaceae\", \"Hydnoraceae\", \"Labiatae\", \"Leucobryaceae\", \"Scrophularaceae\", \"Sterculiaceae\", \"Kahakuloaceae\")\n\n# This is where we can download the barcode data, for all families, in batches, knowing that there are public records\nout1 &lt;- vector(\"list\", length(boldfamilies))\noutnames &lt;- matrix(nrow = length(boldfamilies), ncol = 2)\noutnames[,1] &lt;- boldfamilies\nmarkernames &lt;- c(\"trnL-F\", \"rbcL\", \"matK\", \"ITS\")",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-3.-run-a-loop-that-outputs-in-each-iteration-a-separate-.csv-file-for-each-family-included-in-the-boldfamilies-vector.-we-first-split-the-boldfamilies-object-into-three-lists-to-stay-within-the-request-limits-for-the-bold-api.",
    "href": "building_bold.html#step-3.-run-a-loop-that-outputs-in-each-iteration-a-separate-.csv-file-for-each-family-included-in-the-boldfamilies-vector.-we-first-split-the-boldfamilies-object-into-three-lists-to-stay-within-the-request-limits-for-the-bold-api.",
    "title": "Building the BOLD dataset",
    "section": "Step 3. Run a loop that outputs in each iteration a separate .csv file for each family included in the “boldfamilies” vector. We first split the boldfamilies object into three lists to stay within the request limits for the BOLD API.",
    "text": "Step 3. Run a loop that outputs in each iteration a separate .csv file for each family included in the “boldfamilies” vector. We first split the boldfamilies object into three lists to stay within the request limits for the BOLD API.\n\nfirst_third &lt;- floor((length(boldfamilies)/3))\nsecond_third &lt;- floor(length(boldfamilies) - floor((length(boldfamilies)/3)))\nlast_third &lt;- floor(length(boldfamilies))\n\nboldfamilies1 &lt;- boldfamilies[1:first_third]\nboldfamilies2 &lt;- boldfamilies[first_third:second_third]\nboldfamilies3 &lt;- boldfamilies[second_third:last_third]\n\n# Download data for the first third of families\n    for(i in 1:length(boldfamilies1)){\n        out1[[i]] &lt;- bold_seqspec(boldfamilies1[i], marker = markernames)\n        filename&lt;-paste(\"./family_csvs/\",boldfamilies1[i],\".csv\",sep = \"\")\n        outnames[i,2] &lt;- filename\n        write.csv(file = filename, out1[[i]])\n    }\n\n# Download data for the second third of families\n    for(i in 2:length(boldfamilies2)){\n        out1[[i]] &lt;- bold_seqspec(boldfamilies2[i], marker = markernames)\n        filename &lt;- paste(\"./family_csvs/\",boldfamilies2[i],\".csv\",sep = \"\")\n        outnames[i,2] &lt;- filename\n        write.csv(file = filename, out1[[i]])\n    }\n\n# Download data for the last third of families\n    for(i in 2:length(boldfamilies3)){\n        out1[[i]] &lt;- bold_seqspec(boldfamilies3[i], marker = markernames)\n        filename &lt;- paste(\"./family_csvs/\",boldfamilies3[i],\".csv\",sep = \"\")\n        outnames[i,2] &lt;- filename\n        write.csv(file = filename, out1[[i]])\n    }",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-4-write-bold-search-term-lists-to-keep-track-of-what-was-included-in-this-batch-effort.",
    "href": "building_bold.html#step-4-write-bold-search-term-lists-to-keep-track-of-what-was-included-in-this-batch-effort.",
    "title": "Building the BOLD dataset",
    "section": "Step 4: Write BOLD search term lists to keep track of what was included in this batch effort.",
    "text": "Step 4: Write BOLD search term lists to keep track of what was included in this batch effort.\n\nwrite.csv(file = \"ListofBoldPhyla_to_Families\", boldfamilies)\nboldfamilies &lt;- read.csv(file = \"ListofBoldPhyla_to_Families\")$x\nwrite.csv(file = \"ListofBoldPhyla_to_Families_nopublicrecords\", nopublicrecords)",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-5-read-in-the-files-that-were-output-to-make-the-composite-combtab-dataset-across-all-families.",
    "href": "building_bold.html#step-5-read-in-the-files-that-were-output-to-make-the-composite-combtab-dataset-across-all-families.",
    "title": "Building the BOLD dataset",
    "section": "Step 5: Read in the files that were output to make the composite “combtab” dataset across all families.",
    "text": "Step 5: Read in the files that were output to make the composite “combtab” dataset across all families.\n\nout3 &lt;- vector(\"list\", length(boldfamilies))\n    for(i in 1:length(boldfamilies)){\n        filetemp &lt;- paste(\"./family_csvs/\", boldfamilies[i],\".csv\",sep = \"\")\n        if (file.exists(filetemp))\n        out3[[i]] &lt;- read.csv(filetemp)\n    }",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-6-obtain-list-of-families-that-downloaded-with-zero-entries.",
    "href": "building_bold.html#step-6-obtain-list-of-families-that-downloaded-with-zero-entries.",
    "title": "Building the BOLD dataset",
    "section": "Step 6: Obtain list of families that downloaded with zero entries.",
    "text": "Step 6: Obtain list of families that downloaded with zero entries.\n\nzerodata &lt;- boldfamilies[which(lapply(out3, ncol) != 81)] # 81 is the column with marker codes - this is selecting elements from boldfamilies where the corresponding elements in out3 do not have 81 columns\nwrite.csv(file = \"ListofBoldPhyla_to_Families_zerodata\", zerodata)\nout3.1 &lt;- out3[which(lapply(out3, ncol) == 81)]\n    \nout4 &lt;- do.call(rbind, out3.1)\nwrite.csv(file = \"BoldPhyla_to_Families.csv\", out4)",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-7-load-and-merge-out-files-of-interest-dereplicate-and-combine-them-in-ways-that-list-the-markers",
    "href": "building_bold.html#step-7-load-and-merge-out-files-of-interest-dereplicate-and-combine-them-in-ways-that-list-the-markers",
    "title": "Building the BOLD dataset",
    "section": "Step 7: load and merge “out” files of interest, dereplicate, and combine them in ways that list the markers",
    "text": "Step 7: load and merge “out” files of interest, dereplicate, and combine them in ways that list the markers\n\nintab &lt;- read.csv(\"BoldPhyla_to_Families.csv\")\n\ncombtab &lt;- intab[,1:68] # note that in the current combtab we select the following columns listed below\n\n## columns to keep: \"processid\", \"institution_storing\", \"phylum_taxID\", \"phylum_name\", \"class_taxID\", \"class_name\", \"order_taxID\", \"order_name\", \"family_taxID\", \"family_name\", \"subfamily_taxID\", \"subfamily_name\", \"genus_taxID\", \"genus_name\", \"species_taxID\", \"species_name\", \"subspecies_taxID\", \"subspecies_name\" \n\ncombtab &lt;- combtab[which(duplicated(combtab[c(3,8,11:26)]) == F),] \n\nlength(unique(intab$family_name))\nlength(unique(combtab$family_name))",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-8.-annotate-combtab-to-include-barcodes-associated-with-each-specimen---rbcl-matk-trnl-its.",
    "href": "building_bold.html#step-8.-annotate-combtab-to-include-barcodes-associated-with-each-specimen---rbcl-matk-trnl-its.",
    "title": "Building the BOLD dataset",
    "section": "Step 8. Annotate combtab to include barcodes associated with each specimen - rbcL, matK, trnL, ITS.",
    "text": "Step 8. Annotate combtab to include barcodes associated with each specimen - rbcL, matK, trnL, ITS.\n\nmarkers &lt;- matrix(nrow = nrow(combtab),ncol = 5, \"\")\ncolnames(markers) &lt;- c(\"rbcL\",\"matK\",\"trnL\", \"ITS2\", \"multi\")\n\nlevels(intab$markercode)\n\nmarkers[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"rbcL\", \"rbcLa\")),]$processid),1] &lt;- \"rbcL\"\n\nmarkers[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"matK\")),]$processid),2] &lt;- \"matK\"\n\nmarkers[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"trnL\", \"trnL-F\")),]$processid),3] &lt;- \"trnL\"\n\nmarkers[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"ITS\", \"ITS2\")),]$processid),4] &lt;- \"ITS\"\n\nmarkers[,5] &lt;- apply(markers[,1:4] , 1, paste , collapse = \"-\" )\n\nmarker_df &lt;- as.data.frame(markers)\nunique(marker_df$multi)",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-9.-save-genbank-information-and-combine-markers-list-to-combtab-object",
    "href": "building_bold.html#step-9.-save-genbank-information-and-combine-markers-list-to-combtab-object",
    "title": "Building the BOLD dataset",
    "section": "Step 9. Save GENBANK information and combine markers list to combtab object",
    "text": "Step 9. Save GENBANK information and combine markers list to combtab object\n\n# Save genbank info\ngenbank &lt;- matrix(nrow = nrow(combtab),ncol = 4, \"\")\ncolnames(genbank) &lt;- c(\"gb_rbcL\",\"gb_matK\",\"gb_trnL\", \"gb_ITS\")\n\ngenbank[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"rbcL\", \"rbcLa\")),]$processid),1] &lt;-intab[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"rbcL\", \"rbcLa\")),]$processid),]$genbank_accession\n\ngenbank[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"matK\")),]$processid),2] &lt;- intab[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"matK\")),]$processid),]$genbank_accession\n\ngenbank[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"trnL-F\")),]$processid),3] &lt;- intab[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"trnL\", \"trnL-F\")),]$processid),]$genbank_accession\n\ngenbank[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"ITS\", \"ITS2\")),]$processid),4] &lt;- intab[which(combtab$processid %in% intab[which(intab$markercode %in% c(\"ITS\", \"ITS2\")),]$processid),]$genbank_accession\n\n# Combine markers list to combtab\ncombtab &lt;- cbind(combtab, markers, genbank)",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "building_bold.html#step-10.-filter-columns-that-make-the-file-unnecessarily-large-and-write-combtab-object",
    "href": "building_bold.html#step-10.-filter-columns-that-make-the-file-unnecessarily-large-and-write-combtab-object",
    "title": "Building the BOLD dataset",
    "section": "Step 10. Filter columns that make the file unnecessarily large and write combtab object",
    "text": "Step 10. Filter columns that make the file unnecessarily large and write combtab object\nThis block will generate the same file structure as dataset S1 in the Supplement.\n\nnames(combtab)\ncombtabout &lt;- combtab[, c(2:3,8,11:26,35:36,49:53,57:61,69:77)]\nhead(combtabout, 2)\nwrite.csv(file = \"../data/Kartzinel_et_al_Dataset_S1_20240725.csv\", combtabout)",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "geocov_figs1.html",
    "href": "geocov_figs1.html",
    "title": "Coverage by climatic zones",
    "section": "",
    "text": "Figure 1. Read in combtab dataset of global barcode data from BOLD and summarize.\nThis notebook will generate plots of geographic coverage of barcodes available on BOLD, in relation to climatic zones, and for several genetic markers. It also assesses contributions to BOLD by Project ID.\nWe trim dataframe outputs to the first two rows for demonstration, but full dataframes will be generated and stored in the R environment when running the code from source.\ncombtab &lt;- read.csv(\"../data/BoldPhyla_to_Families_combtab_v4.csv\")\n#View(combtab_20240624)\n\ncombtab_2 &lt;- (unique(combtab$family_name))\nhead(combtab_2, 2)\n\n[1] \"Acanthaceae\" \"Achariaceae\"\n\nhead(unique(combtab$family_name), 2)\n\n[1] \"Acanthaceae\" \"Achariaceae\"\n\ncombtab_subset_barcodes &lt;- combtab %&gt;% subset(multi != \"---\" & multi != \"\")\nhead(combtab_subset_barcodes, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA                     415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA                \n2        632816          Ruellia inflata               NA                \n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA                          NA\n2                   NA                 NA  NA  NA                          NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA                                                rbcL               \n2   NA  Brazil           Para                         rbcL matK       ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS\n1        rbcL---                               \n2 rbcL-matK--ITS                               \n\ncombtab_split_barcodes &lt;- strsplit(combtab$multi, \"-\")\nhead(combtab_split_barcodes, 2)\n\n[[1]]\n[1] \"rbcL\" \"\"     \"\"    \n\n[[2]]\n[1] \"rbcL\" \"matK\" \"\"     \"ITS\" \n\nhead(unlist(combtab_split_barcodes)[which(unlist(combtab_split_barcodes)!=\"\")], 2)\n\n[1] \"rbcL\" \"rbcL\"\n\nlength(which(unlist(combtab_split_barcodes)!=\"\"))\n\n[1] 372460\n\n# Convert blank cells to NA\ncombtab[combtab == \"\"] &lt;- NA\n\n# Count the number of barcodes per specimen\ncombtab$barcode_count &lt;- rowSums(!is.na(combtab[, c(\"rbcL\", \"matK\", \"trnL\", \"ITS2\")]))\n\n# Calculate the total number of barcodes across all rows\ntotal_barcodes &lt;- sum(combtab$barcode_count)\n\n# Display the results\n#View(combtab)\ntotal_barcodes\n\n[1] 373582\n\n# write combtab\ncombtab &lt;- combtab \nwrite.csv(combtab, \"../data/combtab.csv\")\n\n# write out combtab here for supplementary/supporting information \nlength(unique(combtab$species_name))\n\n[1] 102887\n\nlength(unique(combtab$country))\n\n[1] 208\n\nlength(unique(combtab$family_name))\n\n[1] 651\n\nlength(unique(combtab$family_name))\n\n[1] 651\n\n# calculate % north of tropic of cancer, south of tropic of capricorn, and between the two \ncombtab_north_of_tropic_of_cancer &lt;- combtab %&gt;% subset(lat &gt; 23.4)\nhead(combtab_north_of_tropic_of_cancer, 2)\n\n    X.1   X   processid      institution_storing phylum_taxID   phylum_name\n106 152 152 GBVU4228-13 Mined from GenBank, NCBI           12 Magnoliophyta\n107 153 153 GBVX3812-15 Mined from GenBank, NCBI           12 Magnoliophyta\n    class_taxID    class_name order_taxID order_name family_taxID family_name\n106          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n107          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n    subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n106              NA           &lt;NA&gt;      554651 Clarkeasia        554652\n107              NA           &lt;NA&gt;      210661  Avicennia        641297\n             species_name subspecies_taxID subspecies_name collectiondate_start\n106 Clarkeasia parviflora               NA            &lt;NA&gt;                   NA\n107 Avicennia officinalis               NA            &lt;NA&gt;                   NA\n    collectiondate_end     lat     lon                      coord_source\n106                 NA 28.3009 84.1339 Coordinates from country centroid\n107                 NA 23.5863 81.1730 Coordinates from country centroid\n    coord_accuracy elev country province_state   region sector exactsite rbcL\n106             NA   NA   Nepal           &lt;NA&gt; Narayani   &lt;NA&gt;      &lt;NA&gt; rbcL\n107             NA   NA   India           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt;\n    matK trnL ITS2   multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count\n106 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1\n107 matK &lt;NA&gt; &lt;NA&gt; -matK--    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1\n\ncombtab_south_of_tropic_of_capricorn &lt;- combtab %&gt;% subset(lat &lt; -23.4)\nhead(combtab_south_of_tropic_of_capricorn, 2)\n\n   X.1  X   processid\n48  55 55 GBVU4382-13\n52  60 60  KNPA505-09\n                                                        institution_storing\n48                                                 Mined from GenBank, NCBI\n52 University of Johannesburg, Department of Botany and Plant Biotechnology\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n48           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n52           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n48       148533 Acanthaceae              NA           &lt;NA&gt;      554845\n52       148533 Acanthaceae              NA           &lt;NA&gt;      205058\n   genus_name species_taxID               species_name subspecies_taxID\n48 Petalidium        554846   Petalidium oblongifolium               NA\n52   Ruspolia        205059 Ruspolia hypocrateriformis               NA\n   subspecies_name collectiondate_start collectiondate_end      lat     lon\n48            &lt;NA&gt;                   NA                 NA -28.5536 24.7525\n52            &lt;NA&gt;                   NA                 NA -23.9440 31.7250\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n52                              &lt;NA&gt;             NA  208 South Africa\n   province_state region               sector\n48           &lt;NA&gt;   &lt;NA&gt;                 &lt;NA&gt;\n52        Limpopo   &lt;NA&gt; Kruger National Park\n                                            exactsite rbcL matK trnL ITS2\n48                                               &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n52 Kruger National Park, Nxanatseni region  North,  L rbcL matK &lt;NA&gt; &lt;NA&gt;\n         multi  gb_rbcL  gb_matK gb_trnL gb_ITS barcode_count\n48     rbcL--- FJ868916     &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1\n52 rbcL-matK-- KY632577 KY632577    &lt;NA&gt;   &lt;NA&gt;             2\n\ncombtab_between_cancer_capricorn &lt;- combtab %&gt;% subset(lat &gt;= -23.4 & lat &lt;= 23.4)\nhead(combtab_between_cancer_capricorn, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n50  57 57 GENG1760-16 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n50          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n50          264310    Acanthoideae      148534    Ruellia            NA\n             species_name subspecies_taxID subspecies_name collectiondate_start\n49 Thunbergia grandiflora               NA            &lt;NA&gt;                   NA\n50                   &lt;NA&gt;               NA            &lt;NA&gt;                   NA\n   collectiondate_end    lat    lon    coord_source coord_accuracy elev country\n49                 NA 22.306 73.278 Garmin etrax 10             NA  130   India\n50                 NA 21.615 70.505            &lt;NA&gt;             NA  532   India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n50        Gujarat Junagadh   &lt;NA&gt;     Etava rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1\n50 KJ535203    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1",
    "crumbs": [
      "Geographic coverage",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Coverage by climatic zones</span>"
    ]
  },
  {
    "objectID": "geocov_figs1.html#assess-project-contibutions.",
    "href": "geocov_figs1.html#assess-project-contibutions.",
    "title": "Coverage by climatic zones",
    "section": "Assess Project contibutions.",
    "text": "Assess Project contibutions.\nThis block will assess the localized sampling projects’ contributions to the overall BOLD database.\n\n# make container column \n# overall\nhead(combtab[grep(\"UHURU\", combtab$processid),], 2)\n\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           &lt;NA&gt;      148750\n60       148533 Acanthaceae              NA           &lt;NA&gt;      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            &lt;NA&gt;                   NA                 NA 0.4810 36.8740\n60            &lt;NA&gt;                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n60         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count\n59 KM255065   &lt;NA&gt;             3\n60 JX517979   &lt;NA&gt;             3\n\ncombtab$container&lt;-gsub(\"[0-9.-]\", \"\", combtab$processid)\nlength(unique(combtab$container))\n\n[1] 379\n\nsort(table(combtab$container), decreasing=T) #PNG, YNPBP, UHURU\n\n\nGBITS PGBMA  GBVX  GBVP   JWP  GBVA  GBVC  GBVU  GBVE  GBVS  GBVF  GBVW  GBVI \n70028 10890  8000  6694  6103  5270  4999  4989  4983  4983  4979  4959  4953 \n GBVM  GBVL  GBVG  GBVH  GBVK  GBVJ  GBVB  GBVD  GBVT  GBVR  SAFH  GBVO  GBVN \n 4939  4935  4920  4915  4898  4886  4870  4864  4854  4773  4271  3810  3668 \n GBVY BABRU POWNA  EBLF  GBVQ CPBOL  CRCZ   FCA  FBPL MHPAD   DPC   SDH UHURU \n 3629  3232  3174  3127  2863  2527  2450  2179  2143  2126  1780  1733  1720 \n GENG EDTOL  PNOR  KNPA VPSBC  FPUK PLOMA BRYCA IDRCG IPSUB TCAFR ABGCO MHPAF \n 1708  1581  1474  1339  1279  1240  1149  1125  1061   839   780   665   630 \nMKPCH  PLID CANGI GRASS   PNG SALIX YNPBP  BATT CALAK FSEUS GRDMO  AUSG MHPAC \n  622   590   564   553   551   540   527   520   508   502   498   479   448 \n  TRM MHPAA  TDEF  SCBI CANGA GCUDG PRTRE   KSR ALOAF   API FAUCT HOSAM   TSA \n  434   432   429   425   422   384   379   376   350   349   342   341   338 \n NNOR FPOON  KNPB  SBIO WABLK TRIOP   ALM ANGMD CSPPA VEMSH TMBRY NOVOA GRDTX \n  337   331   330   324   319   315   314   313   301   297   296   281   280 \n  FGB  PHAK GCUBG ITVPL APOSA PSYAF MXBZI TADCR CAATB   PIM POWNB CYPAF DBFZP \n  272   260   256   254   243   233   226   221   214   213   211   205   202 \nFYNBL   VPL RBTEP  FOND EGPAM MAPLT  PNCA HOLIN   POA BPTPS   ECU  ITVI MARQF \n  199   197   196   195   188   188   187   184   184   181   179   176   175 \nTRIKU BRYBC  CYAF IASVF HAIDA BBYUK  MADA    HB MXBTX BRALT  SERC   CPL  CPPB \n  175   174   173   172   170   164   164   160   160   159   159   157   148 \nPEPER   SAA  PLGE  BPNP GPAGA  KPLA  CROT ENDEM COBIN UGEAB  WREP MKTRT  FLSH \n  147   143   142   140   138   137   135   135   127   122   120   119   117 \nMADPL BSCAT   RBG PLKEN CAREX MKCRA CONOP NECLE DBMPP SFFIP   YHT   LWT   WAG \n  111   108   100    99    94    93    92    92    91    89    89    87    85 \nSASCH CREUA LEDCL LTRBN ZERGT  SLNM  OSCH  RUPL ORPOL LOPHZ POEUA RBPLT VPSEA \n   84    83    83    83    83    82    81    81    79    78    78    78    76 \nPLCHA  CRBS PCABL BRPLT KIFNE PANFT PLTHU  BTAM  GRII MEXCO PLNOR VLUZH KIFRH \n   75    74    74    73    72    70    69    68    68    68    63    63    62 \n BFAA COBIM  DBZN MLTVP  MPIN PLCOC RINGV  AGOP PLALG   SAP   AGL ATRIP  FSSM \n   61    60    60    60    60    60    58    55    55    55    54    54    54 \nPIPER  CERF  BAMP MIPDG ZPLPP   CSU DVHTF  DIDA   INB  SIDA SWFRG BRYUM  DBHI \n   53    51    50    50    49    48    47    46    46    46    46    44    44 \n CGII  MSTH JSUIS  HERB  IMDB KBGPP  NTDB KUDZU MKSAL CACRB IHGTI ITVRT TCHDC \n   43    43    42    41    40    40    40    39    39    38    36    36    35 \nKIFMO   THY  TNAU BBIHP CINCH INDET  PDBA  DBTS FERNO  FMED  SYKO PLNIP FAGRB \n   34    34    34    33    32    31    31    30    29    29    29    28    27 \nPLNIA LCBAR CACMK FFFCC MELIA   MBB PLWEL CRCBS PGLLP ACBRC AGMCV KIFHE   ATG \n   27    26    25    24    23    22    22    21    21    20    20    19    18 \n  BMS FQAGM SMPRS  CRCB GTICO TFOAX CRCBT PCUBC RBGEV AGVMK BBOBC  USMF   SDP \n   18    18    18    17    17    15    14    14    14    13    13    13    12 \nCACTB ITICS KIFAT MKOXY STRBS THYME ITVGA MHPAB NELKE PLCHU  PLNB PLPAR  PTOC \n   11    11    11    11    11    11    10    10    10    10    10    10    10 \n UADY AGVRB FAGMK  HRUC IMMEX  PMRB SABIO BBOTP LIVCA   MCT PCCMN PLTOR SEQLD \n   10     9     9     9     9     9     9     8     8     8     8     8     8 \n SPBL AUCAS CABAR RHEUM VASCB ALSEU BSRUG  DBTB  PHSN PLLAM   RBJ ABCBF ACCCO \n    8     7     7     7     7     6     6     6     6     6     6     5     5 \n BEER BHEPS CBIHP  DRAC IIPSA  MAHA  MPNE  MTSS NPOAF  PLON QUNAM RSUJO  SSAA \n    5     5     5     5     5     5     5     5     5     5     5     5     5 \n  CBL CSPPB EMPWG  RICE   BUL COMPL   GRJ ITICZ MSHQU  MTAT PCYMX  RJAS  AMBC \n    4     4     4     4     3     3     3     3     3     3     3     3     2 \nBCBSL  DCCC   GYM  HIMS  HRBC  KFRI LGRAS ORIGV PLPET PLSUD SEEWI  STRM SUSHI \n    2     2     2     2     2     2     2     2     2     2     2     2     2 \n  AKD   APP   ASJ DBALT  DLFW DMCSI DRCLS EOCCF  GUTB   ISO LAARS LADEE LAHAR \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \nLAMSK MASMD MCAND MCBRT MCCAL MCGFB MCIII MCJNM MCMAN MCUII MCUKI MCVAD MCYMB \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \n PCGM PLBRU PLMUS PLREN SDCCF SIDBG  SLAT   SLX  SPAP  SPAR   SRB THIPP  TRNT \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \n  UMS   WKA \n    1     1 \n\n# for trnL\nlength(unique(combtab$container[which(combtab$trnL==\"trnL\")]))\n\n[1] 40\n\nsort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T) #PNG, YNPBP, UHURU\n\n\nUHURU BRYCA YNPBP   PNG TMBRY BRYBC  MADA BRALT HAIDA   YHT PANFT  DBZN KIFRH \n 1598  1125   502   496   296   174   164   159   144    89    70    60    51 \nEDTOL  MPIN  FOND BBIHP KIFMO SASCH  SAFH   SAA GTICO KIFAT SABIO IMMEX INDET \n   50    49    47    33    32    32    24    19    17    11     9     8     8 \nLIVCA   MCT MIPDG   LWT CBIHP   CBL EMPWG   TSA APOSA MKPCH  NNOR VASCB  FBPL \n    8     8     7     6     5     4     4     4     3     2     2     2     1 \nMKTRT \n    1 \n\n# percent of trnL sequences originating from top 5\nsum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)[1:5])/sum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)) \n\n[1] 0.7545079\n\n(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)[1:5])/sum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)) \n\n\n     UHURU      BRYCA      YNPBP        PNG      TMBRY \n0.30015026 0.21130729 0.09429001 0.09316304 0.05559730 \n\n# number of specimen records mined from genbank \ncombtab_mined_from_genbank&lt;- subset (combtab, institution_storing == \"Mined from GenBank, NCBI\")\nhead(combtab_mined_from_genbank, 2)\n\n  X.1  X     processid      institution_storing phylum_taxID   phylum_name\n4  11 11 GBITS29777-21 Mined from GenBank, NCBI           12 Magnoliophyta\n5  12 12 GBITS29782-21 Mined from GenBank, NCBI           12 Magnoliophyta\n  class_taxID    class_name order_taxID order_name family_taxID family_name\n4          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n5          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n  subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n4              NA           &lt;NA&gt;      148601 Aphelandra        801590\n5              NA           &lt;NA&gt;      148601 Aphelandra       1100819\n            species_name subspecies_taxID subspecies_name collectiondate_start\n4      Aphelandra hylaea               NA            &lt;NA&gt;                   NA\n5 Aphelandra maximiliana               NA            &lt;NA&gt;                   NA\n  collectiondate_end lat lon coord_source coord_accuracy elev country\n4                 NA  NA  NA         &lt;NA&gt;             NA   NA    &lt;NA&gt;\n5                 NA  NA  NA         &lt;NA&gt;             NA   NA    &lt;NA&gt;\n  province_state region sector exactsite rbcL matK trnL ITS2  multi gb_rbcL\n4           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  ITS #NAME?    &lt;NA&gt;\n5           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  ITS #NAME?    &lt;NA&gt;\n  gb_matK gb_trnL gb_ITS barcode_count container\n4    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1     GBITS\n5    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1     GBITS\n\n# number of specimens in combtab identified to species\ncombtab_IDd_to_species &lt;- subset(combtab, species_name != \"\")\nhead(combtab_IDd_to_species, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           &lt;NA&gt;      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            &lt;NA&gt;\n2        632816          Ruellia inflata               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n2   NA  Brazil           Para   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1       API\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n\n# number of sequences mined from genbank \ncombtab_mined_from_genbank&lt;- subset (combtab, institution_storing == \"Mined from GenBank, NCBI\")\nhead(combtab_mined_from_genbank, 2)\n\n  X.1  X     processid      institution_storing phylum_taxID   phylum_name\n4  11 11 GBITS29777-21 Mined from GenBank, NCBI           12 Magnoliophyta\n5  12 12 GBITS29782-21 Mined from GenBank, NCBI           12 Magnoliophyta\n  class_taxID    class_name order_taxID order_name family_taxID family_name\n4          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n5          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n  subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n4              NA           &lt;NA&gt;      148601 Aphelandra        801590\n5              NA           &lt;NA&gt;      148601 Aphelandra       1100819\n            species_name subspecies_taxID subspecies_name collectiondate_start\n4      Aphelandra hylaea               NA            &lt;NA&gt;                   NA\n5 Aphelandra maximiliana               NA            &lt;NA&gt;                   NA\n  collectiondate_end lat lon coord_source coord_accuracy elev country\n4                 NA  NA  NA         &lt;NA&gt;             NA   NA    &lt;NA&gt;\n5                 NA  NA  NA         &lt;NA&gt;             NA   NA    &lt;NA&gt;\n  province_state region sector exactsite rbcL matK trnL ITS2  multi gb_rbcL\n4           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  ITS #NAME?    &lt;NA&gt;\n5           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  ITS #NAME?    &lt;NA&gt;\n  gb_matK gb_trnL gb_ITS barcode_count container\n4    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1     GBITS\n5    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1     GBITS\n\ncombtab_mined_from_genbank[combtab_mined_from_genbank == \"\"] &lt;- NA # Convert blank cells to NA\ncombtab_mined_from_genbank$barcode_count_mined &lt;- rowSums(!is.na(combtab_mined_from_genbank[, c(\"rbcL\", \"matK\", \"trnL\", \"ITS2\")])) # Count the number of barcodes per specimen\ntotal_barcodes_mined &lt;- sum(combtab_mined_from_genbank$barcode_count_mined) # Calculate the total number of barcodes across all rows\n#View(combtab_mined_from_genbank)\ntotal_barcodes_mined\n\n[1] 199591\n\n# number of specimens in combtab with rbcL barcode \ncombtab_rbcL_barcodes &lt;- subset(combtab, rbcL != \"\")\nhead(combtab_rbcL_barcodes, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           &lt;NA&gt;      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            &lt;NA&gt;\n2        632816          Ruellia inflata               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n2   NA  Brazil           Para   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1       API\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n\n# number of specimens in combtab with matK barcode \ncombtab_matK_barcodes &lt;- subset(combtab, matK != \"\")\nhead(combtab_matK_barcodes, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of specimens in combtab with ITS barcode \ncombtab_ITS2_barcodes &lt;- subset(combtab, ITS2 != \"\")\nhead(combtab_ITS2_barcodes, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of specimens in combtab with trnL barcode \ncombtab_trnL_barcodes &lt;- subset(combtab, trnL != \"\")\nhead(combtab_trnL_barcodes, 2)\n\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           &lt;NA&gt;      148750\n60       148533 Acanthaceae              NA           &lt;NA&gt;      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            &lt;NA&gt;                   NA                 NA 0.4810 36.8740\n60            &lt;NA&gt;                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n60         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   &lt;NA&gt;             3     UHURU\n60 JX517979   &lt;NA&gt;             3     UHURU\n\n# number of genbank accession numbers in combtab \ncombtab_for_genbank &lt;- combtab\ncombtab_for_genbank[combtab_for_genbank == \"\"] &lt;- NA # Convert blank cells to NA\n\n# Count the number of barcodes per specimen (number of non-NA values per row in the specified columns)\ncombtab_for_genbank$accession_count &lt;- rowSums(!is.na(combtab_for_genbank[, c(\"gb_rbcL\", \"gb_matK\", \"gb_trnL\", \"gb_ITS\")]))\n\n# Calculate the total number of barcodes across all rows (sum of accession_count)\ntotal_accessions &lt;- sum(combtab_for_genbank$accession_count)\n\n# Display the results\n#View(combtab_for_genbank)\ntotal_accessions\n\n[1] 262920\n\n# number of specimens with country listed \ncombtab_countries &lt;- subset(combtab, country != \"\")\nhead(combtab_countries, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of specimens with lat/long listed \ncombtab_lat &lt;- subset(combtab, lat != \"\")\nhead(combtab_lat, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            &lt;NA&gt;      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            &lt;NA&gt;\n49   Thunbergia grandiflora               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GBVU\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GENG\n\ncombtab_lon &lt;- subset(combtab, lon != \"\")\nhead(combtab_lon, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            &lt;NA&gt;      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            &lt;NA&gt;\n49   Thunbergia grandiflora               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GBVU\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GENG\n\n# number of matK sequences\ncombtab_matK &lt;- subset(combtab, matK == \"matK\")\nhead(combtab_matK, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of matK sequences with lat/long data \ncombtab_matK_latlong &lt;- subset(combtab_matK, lat != \"\")\nhead(combtab_matK_latlong, 2)\n\n   X.1  X  processid\n51  58 58 IMDB014-14\n52  60 60 KNPA505-09\n                                                        institution_storing\n51             Birla Institute of Technology - Pilani, K.K.Birla Goa Campus\n52 University of Johannesburg, Department of Botany and Plant Biotechnology\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n51           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n52           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n51       148533 Acanthaceae              NA           &lt;NA&gt;      390091\n52       148533 Acanthaceae              NA           &lt;NA&gt;      205058\n   genus_name species_taxID               species_name subspecies_taxID\n51   Acanthus        641300       Acanthus ilicifolius               NA\n52   Ruspolia        205059 Ruspolia hypocrateriformis               NA\n   subspecies_name collectiondate_start collectiondate_end      lat     lon\n51            &lt;NA&gt;                   NA                 NA  15.5256 73.8753\n52            &lt;NA&gt;                   NA                 NA -23.9440 31.7250\n   coord_source coord_accuracy elev      country province_state    region\n51         &lt;NA&gt;             NA   NA        India            Goa North Goa\n52         &lt;NA&gt;             NA  208 South Africa        Limpopo      &lt;NA&gt;\n                 sector                                          exactsite rbcL\n51      Mandovi estuary                                      Chorao Island rbcL\n52 Kruger National Park Kruger National Park, Nxanatseni region  North,  L rbcL\n   matK trnL ITS2       multi  gb_rbcL  gb_matK gb_trnL gb_ITS barcode_count\n51 matK &lt;NA&gt; &lt;NA&gt; rbcL-matK-- DQ028462 DQ028462    &lt;NA&gt;   &lt;NA&gt;             2\n52 matK &lt;NA&gt; &lt;NA&gt; rbcL-matK-- KY632577 KY632577    &lt;NA&gt;   &lt;NA&gt;             2\n   container\n51      IMDB\n52      KNPA\n\n# number of rbcL sequences\ncombtab_rbcL &lt;- subset(combtab, rbcL == \"rbcL\")\nhead(combtab_rbcL, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           &lt;NA&gt;      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            &lt;NA&gt;\n2        632816          Ruellia inflata               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n2   NA  Brazil           Para   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1       API\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n\n# number of rbcL sequences with lat/long data \ncombtab_rbcL_latlong &lt;- subset(combtab_rbcL, lat != \"\")\nhead(combtab_rbcL_latlong, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            &lt;NA&gt;      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            &lt;NA&gt;\n49   Thunbergia grandiflora               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GBVU\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GENG\n\n# number of ITS sequences\ncombtab_ITS &lt;- subset(combtab, ITS2 == \"ITS\")\nhead(combtab_ITS, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of ITS sequences with lat/long data \ncombtab_ITS_latlong &lt;- subset(combtab_ITS, lat != \"\")\nhead(combtab_ITS_latlong, 2)\n\n   X.1  X    processid             institution_storing phylum_taxID\n53  62 62 MHPAD3203-10 Area de Conservacion Guanacaste           12\n54  65 65  MHPAD537-09 Area de Conservacion Guanacaste           12\n     phylum_name class_taxID    class_name order_taxID order_name family_taxID\n53 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n54 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n   family_name subfamily_taxID subfamily_name genus_taxID genus_name\n53 Acanthaceae              NA           &lt;NA&gt;      148750   Justicia\n54 Acanthaceae              NA           &lt;NA&gt;      148750   Justicia\n   species_taxID        species_name subspecies_taxID subspecies_name\n53        317738   Justicia brenesii               NA            &lt;NA&gt;\n54        204815 Justicia arborecens               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end    lat     lon coord_source\n53                   NA                 NA 10.905 -85.279         &lt;NA&gt;\n54                   NA                 NA 10.923 -85.465         &lt;NA&gt;\n   coord_accuracy elev    country province_state\n53             NA  410 Costa Rica       Alajuela\n54             NA 1039 Costa Rica     Guanacaste\n                            region            sector\n53 Area de Conservacion Guanacaste Rincon Rainforest\n54 Area de Conservacion Guanacaste      Sector Cacao\n                                    exactsite rbcL matK trnL ITS2\n53                             Sendero Rincon rbcL matK &lt;NA&gt;  ITS\n54 Estacion Biologica Cacao, Sendero Arenales rbcL matK &lt;NA&gt;  ITS\n            multi  gb_rbcL  gb_matK gb_trnL   gb_ITS barcode_count container\n53 rbcL-matK--ITS AB114507 AB114507    &lt;NA&gt; AB114507             3     MHPAD\n54 rbcL-matK--ITS AF188127 AF188127    &lt;NA&gt; AF188127             3     MHPAD\n\n# number of trnL sequences\ncombtab_trnL &lt;- subset(combtab, trnL == \"trnL\")\nhead(combtab_trnL, 2)\n\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           &lt;NA&gt;      148750\n60       148533 Acanthaceae              NA           &lt;NA&gt;      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            &lt;NA&gt;                   NA                 NA 0.4810 36.8740\n60            &lt;NA&gt;                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n60         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   &lt;NA&gt;             3     UHURU\n60 JX517979   &lt;NA&gt;             3     UHURU\n\n# number of ITS sequences with lat/long data \ncombtab_trnL_latlong &lt;- subset(combtab_trnL, lat != \"\")\nhead(combtab_trnL_latlong, 2)\n\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           &lt;NA&gt;      148750\n60       148533 Acanthaceae              NA           &lt;NA&gt;      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            &lt;NA&gt;                   NA                 NA 0.4810 36.8740\n60            &lt;NA&gt;                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n60         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   &lt;NA&gt;             3     UHURU\n60 JX517979   &lt;NA&gt;             3     UHURU\n\n# number of overall sequences with lat/long data \ncombtab_latlong &lt;- subset(combtab, lat != \"\")\nhead(combtab_latlong, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            &lt;NA&gt;      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            &lt;NA&gt;\n49   Thunbergia grandiflora               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GBVU\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GENG\n\ntable(combtab$trnL)\n\n\ntrnL \n5324 \n\nlevels(factor(combtab$trnL))\n\n[1] \"trnL\"",
    "crumbs": [
      "Geographic coverage",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Coverage by climatic zones</span>"
    ]
  },
  {
    "objectID": "geocov_figs2.html",
    "href": "geocov_figs2.html",
    "title": "Coverage by country",
    "section": "",
    "text": "This notebook analyzes the counts of barcodes by country and plots the results.\n\n## First check for the required packages, install if needed, and load the libraries.\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\n\nBiocManager::install(\"sangerseqR\")\nremotes::install_github(\"ropensci/bold\")\nremotes::install_github(\"ropensci/taxize\")\n\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(maps, ggplot2, dplyr, countrycode, rgbif, data.table, raster, mapproj, sf)\n\n\nSI Figure S1: Map of country counts\nStart with some data cleaning.\n\ncombtab &lt;- read.csv(\"../data/BoldPhyla_to_Families_combtab_v4.csv\")\nhead(combtab, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA                     415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA                \n2        632816          Ruellia inflata               NA                \n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA                          NA\n2                   NA                 NA  NA  NA                          NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA                                                rbcL               \n2   NA  Brazil           Para                         rbcL matK       ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS\n1        rbcL---                               \n2 rbcL-matK--ITS                               \n\n# Round coordiantes to nearest 1 degree\ncombtab$lat &lt;- as.numeric(as.character(combtab$lat))\ncombtab$lon &lt;- as.numeric(as.character(combtab$lon))\n\n# ggplot wrapper of map()\nworld_map &lt;- map_data(\"world\") \n\n# Build a dataframe / matrix of country counts to plot\nmyCodes &lt;- data.frame(table(combtab$country))\ncolnames(myCodes)&lt;-c(\"country\", \"n\")\n\n# Convert country names to \"Getty Thesaurus\" names for BOLD\nmyCodes$country &lt;- countrycode(myCodes$country, \"country.name\", \"country.name\") \nmyCodes$country[which(myCodes$country==\"United States\")]&lt;-\"USA\"\nmyCodes$country[which(myCodes$country==\"United Kingdom\")]&lt;-\"UK\"\nmyCodes$country[which(myCodes$country==\"Congo - Kinshasa\")]&lt;-\"Democratic Republic of the Congo\"\nmyCodes$country[which(myCodes$country==\"Congo - Brazzaville\")]&lt;-\"Republic of Congo\"\nmyCodes$country[which(myCodes$country==\"British Virgin Islands\")]&lt;-\"Virgin Islands\"\nmyCodes$country[which(myCodes$country==\"Bosnia & Herzegovina\")]&lt;-\"Bosnia and Herzegovina\"\nmyCodes$country[which(myCodes$country==\"São Tomé & Príncipe\")]&lt;-\"Sao Tome and Principe\"\nmyCodes$country[which(myCodes$country==\"Trinidad & Tobago\")]&lt;-\"Trinidad\" #Tobago is a separate entity in maps\nmyCodes$country[which(myCodes$country==\"North Macedonia\")]&lt;-\"Macedonia\" \nmyCodes$country[which(myCodes$country==\"Myanmar (Burma)\")]&lt;-\"Myanmar\" \nmyCodes$country[which(myCodes$country==\"Côte d’Ivoire\")]&lt;-\"Ivory Coast\" \nmyCodes$country[which(myCodes$country==\"Czechia\")]&lt;-\"Czech Republic\" \nmyCodes$country[which(myCodes$country==\"Réunion\")]&lt;-\"Reunion\" \nmyCodes$country[which(myCodes$country==\"St. Helena\")]&lt;-\"Saint Helena\" \nmyCodes$country[which(myCodes$country==\"Eswatini\")]&lt;-\"Swaziland\" \n\n\nMap country-level barcode intensity.\n\n# Map for country-level intensity\nmyCodes &lt;- myCodes[is.na(myCodes$country)==F,]\n\nggpoliticalboundaries &lt;- ggplot(myCodes) + \n  geom_map(dat = world_map, map = world_map, aes(map_id = region), fill = \"white\", color = \"#7f7f7f\", linewidth = 0.25)  +\n  geom_map(map = world_map, aes(map_id = country, fill = n), linewidth = 0.25) +\n  scale_fill_gradient(low = \"#fff7bc\", high = \"#cc4c02\", name = \"Worldwide specimens\") + scale_x_continuous(breaks = seq(-180, 180, by = 60)) +\n  scale_y_continuous(breaks = seq(-90, 90, by = 45)) +\n  expand_limits(x = world_map$long, y = world_map$lat) + \n  theme_classic() + \n  ylab(\"\") + \n  xlab(\"\") + \n  theme(legend.position = \"none\") +\n  geom_hline(yintercept = 0, color = \"black\", linewidth = 0.5) + \n  geom_hline(yintercept = 23.5, color = \"black\", linetype = \"dashed\") + \n  geom_hline(yintercept = -23.5, color = \"black\", linetype = \"dashed\") \nggpoliticalboundaries\n\n\n\n\n\n\n\n#ggsave(\"ggpoliticalboundaries_20240626_1.pdf\", ggpoliticalboundaries, width = 13, height = 8.6, units = \"cm\")\n\n\n\nDistribution of country bias - lineplot.\n\n# Line plot with country counts\ncountrycounts_line &lt;- ggplot(myCodes, aes(x = reorder(country, -n), y = n, group = 1)) +\n  geom_line() + \n  theme_classic() + \n  xlab(\"\") + \n  ylab(\"\") +  \n  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank())\ncountrycounts_line\n\n\n\n\n\n\n\n#ggsave(\"countrycounts_20240626.pdf\", countrycounts, width = 8, height = 4, units = \"cm\")\n\n\n\nPrint dataframe with countries having less than 10 barcodes.\n\n# Summarize number of countries with &lt;10 \nmyCodes_less_than_10 &lt;- subset(myCodes, n &lt;10) %&gt;%\n  arrange(desc(n))\nmyCodes_less_than_10\n\n                                  country n\n1                              Cape Verde 9\n2                                 Eritrea 9\n3                            Sierra Leone 9\n4                                Trinidad 9\n5                                    Guam 8\n6                                 Mayotte 8\n7  South Georgia & South Sandwich Islands 8\n8                          Virgin Islands 7\n9                        Falkland Islands 7\n10                            North Korea 7\n11                           Cook Islands 6\n12                   United Arab Emirates 6\n13                                 Kosovo 5\n14                                Belarus 4\n15                                   Chad 4\n16                          Guinea-Bissau 4\n17                                 Kuwait 4\n18                                  Palau 4\n19                                Bermuda 3\n20                          Faroe Islands 3\n21                           Saint Helena 3\n22                                  Tonga 3\n23                               Djibouti 2\n24                                 Gambia 2\n25                                Grenada 2\n26                              Lithuania 2\n27                               Maldives 2\n28                                  Niger 2\n29               Northern Mariana Islands 2\n30                              St. Lucia 2\n31                             San Marino 2\n32                      Antigua & Barbuda 1\n33                                  Aruba 1\n34                             Mauritania 1\n35                                Moldova 1\n36                                   Niue 1\n37               St. Vincent & Grenadines 1\n38                            South Sudan 1",
    "crumbs": [
      "Geographic coverage",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Coverage by country</span>"
    ]
  },
  {
    "objectID": "fetch_itis.html",
    "href": "fetch_itis.html",
    "title": "Fetching taxonomic data from ITIS",
    "section": "",
    "text": "Step 1: Retrieve taxonomic information for families within the plant clade Embryophyta (multicellular plants, excluding green algae) using the ITIS database.\nThis notebook contaions code to fetch family names from ITIS and then create lists of species in each family found in ITIS across the total 730 plant families. The final result here is one file called allFamNames.csv.\n# Retrieve families under \"Embryophyta\"\nfamnames &lt;- taxize::downstream(\"Embryophyta\", db = \"itis\", downto = \"family\") \n# Embryophyta is multicellular plants (excluding green algae)\nfams &lt;- famnames$Embryophyta$taxonname\n# Remove family with problematic records\nfams &lt;- fams[fams != \"Kahukaloaceae\"]\n\n# Initialize data structures\nfamlist &lt;- vector(\"list\", length(fams))\nfamout &lt;- matrix(nrow = length(fams), ncol = 3)\nfamout[,1] &lt;- fams\nlength(fams)",
    "crumbs": [
      "Taxonomic coverage",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Fetching taxonomic data from ITIS</span>"
    ]
  },
  {
    "objectID": "fetch_itis.html#step-1-retrieve-taxonomic-information-for-families-within-the-plant-clade-embryophyta-multicellular-plants-excluding-green-algae-using-the-itis-database.",
    "href": "fetch_itis.html#step-1-retrieve-taxonomic-information-for-families-within-the-plant-clade-embryophyta-multicellular-plants-excluding-green-algae-using-the-itis-database.",
    "title": "Fetching taxonomic data from ITIS",
    "section": "",
    "text": "We found 730 families returned from ITIS.\n\n\nNext we can loop over these families and generate CSV files with all the species in these families.\n\n# Loop over families and save a CSV for each\n    for(i in 1:length(fams)){\n        famlist[[i]] &lt;- taxize::downstream(fams[i], db = \"itis\", downto = \"species\")\n        filename &lt;- paste0(\"../data/family_csvs/\",fams[i],\".csv\",sep = \"\")\n        famout[i,2] &lt;- filename\n        write.csv(file = filename, do.call(rbind, famlist[[i]]))\n        famout[i,3] &lt;- length(which(do.call(rbind, famlist[[i]])$rankname == \"species\"))\n    }\n\n\n\nReassemble data from saved CSV files:\n\nout3 &lt;- vector(\"list\", length(fams)) \n  for(i in 1:length(fams)){ \n    filename &lt;- paste0(\"./data/family_csvs/\",fams[i],\".csv\",sep=\"\") \n    if (file.exists(filename)) out3[[i]] &lt;- read.csv(filename) }\n\n\n\nCombine all data into a single data frame\nThis block generates the list of families used in the Correlations between plant species and DNA barcode availability notebook.\n\nout4 &lt;- do.call(rbind, out3)\ndim(out4)\nout4$family&lt;-do.call(rbind, lapply(strsplit(as.character(out4$X), \"[.]\"), `[[`, 1)) # extract family names\nhead(out4, 2)\nwrite.csv(file=\"../data/allFamNames.csv\", out4)",
    "crumbs": [
      "Taxonomic coverage",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Fetching taxonomic data from ITIS</span>"
    ]
  },
  {
    "objectID": "taxonomic_coverage.html",
    "href": "taxonomic_coverage.html",
    "title": "Correlations between plant species and DNA barcode availability",
    "section": "",
    "text": "SI Appendix Figure 2A-D: Read in files and summarize for panels A-B.\nThis notebook pulls in data from various sources and makes plots to compare plants species per family to availability of DNA barcodes.",
    "crumbs": [
      "Taxonomic coverage",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Correlations between plant species and DNA barcode availability</span>"
    ]
  },
  {
    "objectID": "taxonomic_coverage.html#si-appendix-figure-2a-d-read-in-files-and-summarize-for-panels-a-b.",
    "href": "taxonomic_coverage.html#si-appendix-figure-2a-d-read-in-files-and-summarize-for-panels-a-b.",
    "title": "Correlations between plant species and DNA barcode availability",
    "section": "",
    "text": "First we read in the data and make some quick plots.\nThe combtab data corresponds to the Supplemental Dataset S1 from the publication.\n\ncombtab &lt;- read.csv(\"../data/Kartzinel_et_al_Dataset_S1_20240725.csv\")\nhead(combtab, 2)\n\n   Process.ID        Phylum         Class    Order      Family    Subfamily\n1   API120-12 Magnoliophyta Magnoliopsida Lamiales Acanthaceae             \n2 CANGI002-17 Magnoliophyta Magnoliopsida Lamiales Acanthaceae Acanthoideae\n        Genus                  Species Subspecies Latitude Longitude Country\n1 Peristrophe Peristrophe bicalyculata                  NA        NA        \n2     Ruellia          Ruellia inflata                  NA        NA  Brazil\n  rbcL matK trnL ITS Multiple.markers rbcL.Genbank.accession\n1 rbcL                        rbcL---                       \n2 rbcL matK      ITS   rbcL-matK--ITS                       \n  matK.Genbank.accession trnL.Genbank.accession ITS.Genbank.accession\n1                                                                    \n2                                                                    \n\n# Round coordiantes to nearest 1 degree\ncombtab$lat &lt;- as.numeric(as.character(combtab$Latitude))\ncombtab$lon &lt;- as.numeric(as.character(combtab$Longitude))\n\n# Phylum rank\nbarplot(sort(table(combtab$Phylum), decreasing=T), main = \"Most barcoded Phyla\")\n\n\n\n\n\n\n\n# Family rank\nhead(sort(table(combtab$Family), decreasing=T), 10)\n\n\n     Fabaceae       Poaceae   Orchidaceae    Asteraceae      Rosaceae \n        17808         15624         14575         14410          6802 \n    Rubiaceae    Cyperaceae     Lamiaceae Euphorbiaceae     Ericaceae \n         6690          6214          5325          4863          4057 \n\nbarplot(sort(table(combtab$Family), decreasing=T), main = \"Most barcoded Families\")\n\n\n\n\n\n\n\nhead(table(combtab$Family, combtab$Multiple.markers), 2)\n\n             \n              ---ITS --trnL- -matK-- -matK-trnL- #NAME? rbcL--- rbcL---ITS\n  Acanthaceae    626       2     130          10      0     192          6\n  Achariaceae      2       1      25           0      0     132          0\n             \n              rbcL--trnL- rbcL--trnL-ITS rbcL-matK-- rbcL-matK--ITS\n  Acanthaceae          25              1         285             70\n  Achariaceae           0              0         136              6\n             \n              rbcL-matK-trnL- rbcL-matK-trnL-ITS\n  Acanthaceae              77                 16\n  Achariaceae               1                  1\n\n# the most barcoded plant species in the world\nsort(table(combtab$Species), decreasing=T)[1:5] # by specimens\n\n\n                                          Bryum argenteum \n                        7495                          551 \n         Scorpidium cossonii Acanthorrhynchium papillatum \n                         354                          195 \n              Aneura pinguis \n                         195 \n\n\n\n\nPlot family abundances in ITIS and compare with barcodes: this section gives us panels A and B of the figure\nThe infam data corresponds to the Supplemental Dataset S2 from the publication.\n\ninfam &lt;- read.csv(\"../data/allFamNames.csv\")\nITISfamcount &lt;- sort(table(infam$family), decreasing=T)\n\n# Create a useful matrix for summarizing the BOLD counts with respect to ITIS matches\nfamcountmat &lt;- matrix(0, nrow = length(ITISfamcount), ncol = 9)\ncolnames(famcountmat)&lt;-c(\"rank\", \"ITISfamname\", \"ITISfamcount\", \"BOLDspecimencount\", \"BOLDspeccount\", \"trnLcount\", \"rbcLcount\", \"matKcount\", \"ITScount\")\n  famcountmat&lt;-data.frame(famcountmat)\n  famcountmat[,1]&lt;-seq(1,length(ITISfamcount))\n  famcountmat[,2]&lt;-names(ITISfamcount)\n  famcountmat[,3]&lt;-ITISfamcount\n\n# Make count of specimens by family \ncombtabfamilycount &lt;- table(combtab$Family)\nfamcountmat[,4] &lt;- combtabfamilycount[match(famcountmat[,2], names(combtabfamilycount))]\n\n# Make count of species by family\ncombtabspeciescount &lt;- tapply(combtab$Species, combtab$Family, function(x) length(unique(x)))\nfamcountmat[,5] &lt;- combtabspeciescount[match(famcountmat[,2], names(combtabspeciescount))]\n\n# Make count of trnL by family\ncombtabtrnLcount &lt;- tapply(combtab$trnL, combtab$Family, function(x) length(which(x == \"trnL\")))\nfamcountmat[,6] &lt;- combtabtrnLcount[match(famcountmat[,2], names(combtabtrnLcount))]\n  \n# Make count of rbcL by family\ncombtabrbcLcount &lt;- tapply(combtab$rbcL, combtab$Family, function(x) length(which(x==\"rbcL\")))\nfamcountmat[,7] &lt;- combtabrbcLcount[match(famcountmat[,2], names(combtabrbcLcount))]\n  \n# Make count of matK by family\ncombtabmatKcount &lt;- tapply(combtab$matK, combtab$Family, function(x) length(which(x==\"matK\")))\nfamcountmat[,8] &lt;- combtabmatKcount[match(famcountmat[,2], names(combtabmatKcount))]\n  \n# Make count of ITS by family\ncombtabITScount &lt;- tapply(combtab$ITS, combtab$Family, function(x) length(which(x==\"ITS\")))\nfamcountmat[,9] &lt;- combtabITScount[match(famcountmat[,2], names(combtabITScount))]\n\nwrite.csv(famcountmat, \"../data/DatasetS2_trnL_rbcL_matK_ITS.csv\")\n\n\n\nSummarize the data:\n\nget_genera_from_family &lt;- function(family_name) {\n  tsn &lt;- get_tsn(family_name, rows = 1, db = \"itis\")\n  \n  if (!is.na(tsn)) {\n    result &lt;- downstream(tsn, downto = \"genus\", db = \"wfo\")\n    if (!is.null(result[[1]])) {\n      return(result[[1]]$taxonname)\n    }\n  }\n  return(NULL)\n}\n\n\ninstall.packages(\"rgbif\")\n\n\nThe downloaded binary packages are in\n    /var/folders/0y/r_pk_m1j77vbq82t895ph8780000gq/T//RtmpY3Px6a/downloaded_packages\n\nlibrary(rgbif)\n\n# Function to get genera from GBIF\nget_genera_gbif &lt;- function(family) {\n  res &lt;- name_backbone(name = family, rank = \"family\")  # Get family details\n  if (!is.null(res$usageKey)) {\n    # Search for genera within this family\n    genera_data &lt;- name_usage(key = res$usageKey, rank = \"genus\", limit = 100)\n    return(unique(genera_data$data$scientificName))\n  } else {\n    return(NULL)\n  }\n}\n\n# Example list of plant families\nplant_families &lt;- c(\"Poaceae\", \"Fabaceae\", \"Asteraceae\", \"Orchidaceae\", \"Rosaceae\")\n\n# Retrieve genera for each family\nall_genera &lt;- lapply(plant_families, get_genera_gbif)\nnames(all_genera) &lt;- plant_families\n\n# Print results\nprint(all_genera)\n\n$Poaceae\n[1] \"Poaceae\"\n\n$Fabaceae\n[1] \"Fabaceae\"\n\n$Asteraceae\n[1] \"Asteraceae\"\n\n$Orchidaceae\n[1] \"Orchidaceae\"\n\n$Rosaceae\n[1] \"Rosaceae\"\n\n\n\n# Number of taxa\nnrow(famcountmat)\n\n[1] 730\n\nsum(famcountmat$ITISfamcount)\n\n[1] 51925\n\nrange(famcountmat$ITISfamcount)\n\n[1]    1 5061\n\nquantile(famcountmat$ITISfamcount)\n\n     0%     25%     50%     75%    100% \n   1.00    1.00    4.00   27.75 5061.00 \n\nmedian(famcountmat$ITISfamcount)\n\n[1] 4\n\n# Number of family names in ITIS with barcodes\nlength(which(is.na(famcountmat$BOLDspecimencount) == F))\n\n[1] 609\n\nlength(which(is.na(famcountmat$BOLDspecimencount) == F))/nrow(famcountmat)\n\n[1] 0.8342466\n\n# Number of family names ITIS without barcodes\nlength(which(is.na(famcountmat$BOLDspecimencount)))\n\n[1] 121\n\nlength(which(is.na(famcountmat$BOLDspecimencount)))/nrow(famcountmat)\n\n[1] 0.1657534\n\n# Characterize the no-barcode families (i.e., \"nbc\" families)\nnbcfams &lt;- famcountmat[which(is.na(famcountmat$BOLDspecimencount)),]\nnbcfams &lt;- nbcfams[order(nbcfams$ITISfamcount),] # reorder by ITIS fam size\nhead(nbcfams, 2)\n\n    rank      ITISfamname ITISfamcount BOLDspecimencount BOLDspeccount\n469  469      Alzateaceae            1                NA            NA\n471  471 Ambuchananiaceae            1                NA            NA\n    trnLcount rbcLcount matKcount ITScount\n469        NA        NA        NA       NA\n471        NA        NA        NA       NA\n\ntail(nbcfams, 2)\n\n    rank       ITISfamname ITISfamcount BOLDspecimencount BOLDspeccount\n124  124 Balantiopsidaceae           62                NA            NA\n45    45   Hydrophyllaceae          203                NA            NA\n    trnLcount rbcLcount matKcount ITScount\n124        NA        NA        NA       NA\n45         NA        NA        NA       NA\n\nsum(nbcfams[,3])\n\n[1] 823\n\ndim(nbcfams)\n\n[1] 121   9\n\nhead(sort(nbcfams$ITISfamname), 2) \n\n[1] \"Alzateaceae\"      \"Ambuchananiaceae\"\n\nrange(nbcfams$ITISfamcount)\n\n[1]   1 203\n\nhist(nbcfams$ITISfamcount)\n\n\n\n\n\n\n\nmedian(nbcfams$ITISfamcount)\n\n[1] 1\n\nhead(nbcfams[order(nbcfams[,3]),], 2)\n\n    rank      ITISfamname ITISfamcount BOLDspecimencount BOLDspeccount\n469  469      Alzateaceae            1                NA            NA\n471  471 Ambuchananiaceae            1                NA            NA\n    trnLcount rbcLcount matKcount ITScount\n469        NA        NA        NA       NA\n471        NA        NA        NA       NA\n\nhead(nbcfams[which(nbcfams[,3] == 1),], 2)\n\n    rank      ITISfamname ITISfamcount BOLDspecimencount BOLDspeccount\n469  469      Alzateaceae            1                NA            NA\n471  471 Ambuchananiaceae            1                NA            NA\n    trnLcount rbcLcount matKcount ITScount\n469        NA        NA        NA       NA\n471        NA        NA        NA       NA\n\ndim(nbcfams[which(nbcfams[,3] == 1),])\n\n[1] 68  9\n\nnrow(nbcfams[which(nbcfams[,3] == 1),])/nrow(nbcfams)\n\n[1] 0.5619835\n\nhead(nbcfams[which(nbcfams[,3]&lt;5),], 2)\n\n    rank      ITISfamname ITISfamcount BOLDspecimencount BOLDspeccount\n469  469      Alzateaceae            1                NA            NA\n471  471 Ambuchananiaceae            1                NA            NA\n    trnLcount rbcLcount matKcount ITScount\n469        NA        NA        NA       NA\n471        NA        NA        NA       NA\n\ndim(nbcfams[which(nbcfams[,3]&lt;5),])\n\n[1] 93  9\n\nnrow(nbcfams[which(nbcfams[,3]&lt;5),])/nrow(nbcfams)\n\n[1] 0.768595\n\nhead(nbcfams[which(nbcfams$ITISfamname == \"Heliophytaceae\"),], 2)\n\n[1] rank              ITISfamname       ITISfamcount      BOLDspecimencount\n[5] BOLDspeccount     trnLcount         rbcLcount         matKcount        \n[9] ITScount         \n&lt;0 rows&gt; (or 0-length row.names)\n\nhead(nbcfams[which(nbcfams$ITISfamname == \"Calliergonaceae\"),], 2)\n\n    rank     ITISfamname ITISfamcount BOLDspecimencount BOLDspeccount trnLcount\n203  203 Calliergonaceae           21                NA            NA        NA\n    rbcLcount matKcount ITScount\n203        NA        NA       NA\n\n\n\n# Summarize families in BOLD not in ITIS\nboldfamnames &lt;- unique(combtab$Family)\nlength(boldfamnames) #651\n\n[1] 651\n\n# Families in BOLD not matched by ITIS\nnomatchnames &lt;- boldfamnames[which(boldfamnames %in% famcountmat$ITISfamname == F)]\nnomatchnames &lt;- nomatchnames[which(nomatchnames != \"\")]\nlength(nomatchnames) #42\n\n[1] 42\n\nlength(nomatchnames)/length(boldfamnames) #0.06451613\n\n[1] 0.06451613\n\n# Counts of specimens in families in BOLD not matched by ITIS\ncombtab$family_name &lt;- factor(combtab$Family)\nhead(sort(table(droplevels(combtab[which(combtab$family_name %in% nomatchnames),]$family_name)), decreasing=T), 2)\n\n\nChenopodiaceae  Asphodelaceae \n           818            798 \n\nsum(sort(table(droplevels(combtab[which(combtab$family_name %in% nomatchnames),]$family_name)), decreasing=T))\n\n[1] 3898\n\nsum(sort(table(droplevels(combtab[which(combtab$family_name %in% nomatchnames),]$family_name)), decreasing=T))/nrow(combtab)\n\n[1] 0.01383894\n\nmedian(sort(table(droplevels(combtab[which(combtab$family_name %in% nomatchnames),]$family_name)), decreasing=T))\n\n[1] 8\n\n# Number of specimens not identified to family\nlength(which(combtab$family_name == \"\"))\n\n[1] 0",
    "crumbs": [
      "Taxonomic coverage",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Correlations between plant species and DNA barcode availability</span>"
    ]
  },
  {
    "objectID": "taxonomic_coverage.html#si-appendix-figure-2a-d-plot-panels-a-b",
    "href": "taxonomic_coverage.html#si-appendix-figure-2a-d-plot-panels-a-b",
    "title": "Correlations between plant species and DNA barcode availability",
    "section": "SI Appendix Figure 2A-D: Plot panels A-B",
    "text": "SI Appendix Figure 2A-D: Plot panels A-B\n\n# Plot family count by specimens: Panel A\nplotcorrs &lt;- famcountmat[complete.cases(famcountmat[,3:4]),] \nsummary(lm(log(as.numeric(plotcorrs$BOLDspecimencount)) ~ log(as.numeric(plotcorrs$ITISfamcount))))\n\n\nCall:\nlm(formula = log(as.numeric(plotcorrs$BOLDspecimencount)) ~ log(as.numeric(plotcorrs$ITISfamcount)))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.1891 -0.8690  0.1937  0.8946  4.4466 \n\nCoefficients:\n                                        Estimate Std. Error t value Pr(&gt;|t|)\n(Intercept)                              2.36350    0.07568   31.23   &lt;2e-16\nlog(as.numeric(plotcorrs$ITISfamcount))  0.82925    0.02606   31.82   &lt;2e-16\n                                           \n(Intercept)                             ***\nlog(as.numeric(plotcorrs$ITISfamcount)) ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.301 on 607 degrees of freedom\nMultiple R-squared:  0.6251,    Adjusted R-squared:  0.6245 \nF-statistic:  1012 on 1 and 607 DF,  p-value: &lt; 2.2e-16\n\nplotcorrs_ggplot_BOLDspecimen_ITISfamily &lt;- ggplot(\n  plotcorrs, aes(x=log(ITISfamcount), y=log(BOLDspecimencount))) + \n  geom_point(pch = 1) + \n  theme_classic() + \n  xlab(\"Log of ITIS family count\") + \n  ylab(\"Log of BOLD specimen count\") + \n  geom_abline(intercept = 0, slope = 1, color = \"black\", linewidth = 1, linetype = \"dashed\") + \n  geom_smooth(method = \"lm\", se=FALSE, linewidth=1, color = \"darkgreen\") +\n  scale_y_continuous(breaks = seq(0,9, by = 3)) + \n  scale_x_continuous(breaks = seq(0,9, by = 3))\nplotcorrs_ggplot_BOLDspecimen_ITISfamily\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n#ggsave(\"plotcorrs_ggplot_BOLDspecimen_ITISfamily.pdf\", plotcorrs_ggplot_BOLDspecimen_ITISfamily, width = 10, height = 8, units = \"cm\")\n        \n# Summary stats for panel A\nplotcorrs_summary &lt;- plotcorrs %&gt;% dplyr::summarize(sumspecimens = sum(BOLDspecimencount))\nplotcorrs_summary\n\n  sumspecimens\n1       277771\n\n\n\n# Plot family count by species: PANEL B\nplotcorrs_ggplot_BOLDspecies_ITISfamily &lt;- ggplot(\n  plotcorrs, aes(x=log(ITISfamcount), y=log(BOLDspeccount))) + \n  geom_point(pch = 1) + \n  theme_classic() + \n  xlab(\"Log of ITIS family count\") + \n  ylab(\"Log of BOLD species count\") + \n  geom_abline(intercept = 0, slope = 1, color = \"black\", linewidth = 1, linetype = \"dashed\") + \n  geom_smooth(method = \"lm\", se=FALSE, linewidth=1, color = \"darkgreen\") +\n  scale_y_continuous(breaks = seq(0,9, by = 3)) + scale_x_continuous(breaks = seq(0,9, by = 3))\nplotcorrs_ggplot_BOLDspecies_ITISfamily \n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n#ggsave(\"plotcorrs_ggplot_BOLDspecies_ITISfamily.pdf\", plotcorrs_ggplot_BOLDspecies_ITISfamily, width = 10, height = 8, units = \"cm\")\n        \n#summary stats for panel B\nplotcorrs_summary &lt;- plotcorrs %&gt;% summarize(sumspecies = sum(BOLDspeccount))\nplotcorrs_summary\n\n  sumspecies\n1     101674",
    "crumbs": [
      "Taxonomic coverage",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Correlations between plant species and DNA barcode availability</span>"
    ]
  },
  {
    "objectID": "taxonomic_coverage.html#si-appendix-figure-2a-d-read-in-files-and-summarize-for-panels-c-d.",
    "href": "taxonomic_coverage.html#si-appendix-figure-2a-d-read-in-files-and-summarize-for-panels-c-d.",
    "title": "Correlations between plant species and DNA barcode availability",
    "section": "SI Appendix Figure 2A-D: Read in files and summarize for panels C-D.",
    "text": "SI Appendix Figure 2A-D: Read in files and summarize for panels C-D.\nNow read in the data from downloading all trnL P6 data from the European Nucleotide Archive at EMBL-EBI. More details for the download can be found in the “Building the datasets” section of the Methods in the publication. This data corresponds to dataset S3 in the Supplement.\n\nemblp6 &lt;- read.csv(\"../data/Kartzinel_et_al_Dataset_S3_20240725.csv\")\nnrow(emblp6)\n\n[1] 157020\n\nlength(unique(emblp6$trnL.P6.sequence)) # number of unique sequences \n\n[1] 21467\n\n#levels(factor(emblp6$Family)) # uncomment and run to print out all the family names\nlength(unique(emblp6$Family))\n\n[1] 666\n\n157020/5324 # fold difference between number in BOLD vs EMBL\n\n[1] 29.49286\n\nemblp6_nofamily &lt;- subset(emblp6, Family == \"\")\n\n# Build the same kind of matrix as above\nfamcountmatp6 &lt;- matrix(0, nrow = length(ITISfamcount), ncol = 5)\ncolnames(famcountmatp6) &lt;- c(\"rank\", \"ITISfamname\", \"ITISfamcount\", \"p6seqcount\", \"p6speccount\")\nfamcountmatp6 &lt;- data.frame(famcountmatp6)\nfamcountmatp6[,1] &lt;- seq(1,length(ITISfamcount))\nfamcountmatp6[,2] &lt;- names(ITISfamcount)\nfamcountmatp6[,3] &lt;- ITISfamcount\nlength(unique(emblp6$Family))\n\n[1] 666\n\n#unique(emblp6$family_name) # uncomment to print out all the family names\n\nwrite.csv(famcountmatp6, \"../data/DatasetS2_P6_additions.csv\")\n\n# Make count of specimens by family\nemblp6count &lt;- table(emblp6$Family)\nfamcountmatp6[,4] &lt;- emblp6count[match(famcountmatp6[,2], names(emblp6count))]\nlength(emblp6count)\n\n[1] 666\n\nsum(emblp6count)\n\n[1] 157020\n\n# Make count of species by family\nemblp6speciescount &lt;- tapply(emblp6$Species, emblp6$Family, function(x) length(unique(x)))\nfamcountmatp6[,5] &lt;- emblp6speciescount[match(famcountmatp6[,2], names(emblp6speciescount))]\n\n\nSummarize the data:\n\n# Number of taxa\nnrow(famcountmatp6)\n\n[1] 730\n\nsum(famcountmatp6$ITISfamcount)\n\n[1] 51925\n\nrange(famcountmatp6$ITISfamcount)\n\n[1]    1 5061\n\nquantile(famcountmatp6$ITISfamcount)\n\n     0%     25%     50%     75%    100% \n   1.00    1.00    4.00   27.75 5061.00 \n\nmedian(famcountmatp6$ITISfamcount)\n\n[1] 4\n\n# Number of family names in ITIS with barcodes\nlength(which(is.na(famcountmatp6$p6seqcount) == F))\n\n[1] 611\n\nlength(which(is.na(famcountmatp6$p6seqcount) == F))/nrow(famcountmatp6)\n\n[1] 0.8369863\n\n# Number of family names ITIS without barcodes\nlength(which(is.na(famcountmatp6$p6seqcount)))\n\n[1] 119\n\nlength(which(is.na(famcountmatp6$p6seqcount)))/nrow(famcountmatp6)\n\n[1] 0.1630137\n\n# Characterize the no-barcode families\nnbcfamsp6 &lt;- famcountmatp6[which(is.na(famcountmatp6$p6seqcount)),]\nnbcfamsp6 &lt;- nbcfamsp6[order(nbcfamsp6$ITISfamcount),] # reorder by ITIS fam size\nhead(nbcfamsp6, 2)\n\n    rank   ITISfamname ITISfamcount p6seqcount p6speccount\n469  469   Alzateaceae            1         NA          NA\n472  472 Anarthriaceae            1         NA          NA\n\ntail(nbcfamsp6, 2)\n\n    rank      ITISfamname ITISfamcount p6seqcount p6speccount\n129  129  Selaginellaceae           56         NA          NA\n15    15 Xanthorrhoeaceae          658         NA          NA\n\nsum(nbcfamsp6[,3])\n\n[1] 1069\n\ndim(nbcfamsp6)\n\n[1] 119   5\n\nhead(sort(nbcfamsp6 $ITISfamname), 2)\n\n[1] \"Alzateaceae\"  \"Amphidiaceae\"\n\nrange(nbcfamsp6 $ITISfamcount)\n\n[1]   1 658\n\nhist(nbcfamsp6 $ITISfamcount)\n\n\n\n\n\n\n\nmedian(nbcfamsp6 $ITISfamcount)\n\n[1] 1\n\nhead(nbcfamsp6[order(nbcfamsp6[,3]),], 2)\n\n    rank   ITISfamname ITISfamcount p6seqcount p6speccount\n469  469   Alzateaceae            1         NA          NA\n472  472 Anarthriaceae            1         NA          NA\n\nhead(nbcfamsp6[which(nbcfamsp6[,3]==1),], 2)\n\n    rank   ITISfamname ITISfamcount p6seqcount p6speccount\n469  469   Alzateaceae            1         NA          NA\n472  472 Anarthriaceae            1         NA          NA\n\ndim(nbcfamsp6[which(nbcfamsp6[,3]==1),])\n\n[1] 76  5\n\nnrow(nbcfamsp6[which(nbcfamsp6[,3]==1),])/nrow(nbcfamsp6)\n\n[1] 0.6386555\n\nhead(nbcfamsp6[which(nbcfamsp6[,3]&lt;5),], 2)\n\n    rank   ITISfamname ITISfamcount p6seqcount p6speccount\n469  469   Alzateaceae            1         NA          NA\n472  472 Anarthriaceae            1         NA          NA\n\ndim(nbcfamsp6[which(nbcfamsp6[,3]&lt;5),])\n\n[1] 100   5\n\nnrow(nbcfamsp6[which(nbcfamsp6[,3]&lt;5),])/nrow(nbcfamsp6)\n\n[1] 0.8403361\n\nhead(nbcfamsp6[which(nbcfamsp6 $ITISfamname==\"Heliophytaceae\"),], 2)\n\n[1] rank         ITISfamname  ITISfamcount p6seqcount   p6speccount \n&lt;0 rows&gt; (or 0-length row.names)\n\nhead(nbcfamsp6[which(nbcfamsp6 $ITISfamname==\"Calliergonaceae\"),], 2)\n\n[1] rank         ITISfamname  ITISfamcount p6seqcount   p6speccount \n&lt;0 rows&gt; (or 0-length row.names)\n\n\n\n# Summarize families in embl not in ITIS\np6famnames &lt;- unique(emblp6$Family)\nlength(p6famnames)\n\n[1] 666\n\n# Families in embl not matched by ITIS\nnomatchnamesp6 &lt;- p6famnames[which(p6famnames %in% famcountmatp6$ITISfamname == F)]\nnomatchnamesp6 &lt;- nomatchnamesp6[which(nomatchnamesp6 != \"\")]\nlength(nomatchnamesp6)\n\n[1] 55\n\nlength(nomatchnamesp6)/length(p6famnames)\n\n[1] 0.08258258\n\n# Counts of specimens in families in embl not matched by ITIS\nemblp6$family_name &lt;- factor(emblp6$Family)\nhead(sort(table(droplevels(emblp6[which(emblp6 $family_name %in% nomatchnamesp6),]$family_name)), decreasing=T), 2)\n\n\n Hyacinthaceae Chenopodiaceae \n           672            347 \n\nsum(sort(table(droplevels(emblp6[which(emblp6 $family_name %in% nomatchnamesp6),]$family_name)), decreasing=T))\n\n[1] 1809\n\nsum(sort(table(droplevels(emblp6[which(emblp6 $family_name %in% nomatchnamesp6),]$family_name)), decreasing=T))/nrow(combtab)\n\n[1] 0.006422432\n\nmedian(sort(table(droplevels(combtab[which(combtab$family_name %in% nomatchnamesp6),]$family_name)), decreasing=T))\n\n[1] 8\n\n# Number of specimens not identified to family\nlength(which(emblp6$family_name == \"\"))\n\n[1] 0\n\n\n\n\nWrite out the Supplemental Dataset S2\n\nds_s2 &lt;- merge(famcountmat, famcountmatp6, by=c(\"rank\",\"ITISfamname\",\"ITISfamcount\"))\nwrite.csv(ds_s2, glue(\"../data/Kartzinel_et_al_Dataset_S2_{params$today}.csv\"))",
    "crumbs": [
      "Taxonomic coverage",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Correlations between plant species and DNA barcode availability</span>"
    ]
  },
  {
    "objectID": "taxonomic_coverage.html#si-appendix-figure-2a-d-plot-panels-c-d",
    "href": "taxonomic_coverage.html#si-appendix-figure-2a-d-plot-panels-c-d",
    "title": "Correlations between plant species and DNA barcode availability",
    "section": "SI Appendix Figure 2A-D: Plot panels C-D",
    "text": "SI Appendix Figure 2A-D: Plot panels C-D\n\n# Plot correlations - family count by specimens: Panel C\nplotcorrs &lt;- famcountmatp6[complete.cases(famcountmatp6[,3:4]),]\nplotcorrs_ggplot_family_sequences &lt;- ggplot(\n  plotcorrs, aes(x=log(ITISfamcount), y=log(p6seqcount))) + \n  geom_point(pch = 1) + \n  theme_classic() + \n  xlab(\"Log of ITIS family count\") + \n  ylab(\"Log of trnL-P6 sequence count\") + \n  geom_abline(intercept = 0, slope = 1, color = \"black\", linewidth = 1, linetype = \"dashed\") + \n  geom_smooth(method = \"lm\", se=FALSE, linewidth=1, color = \"darkgreen\") +\n  scale_y_continuous(breaks = seq(0,9, by = 3)) + \n  scale_x_continuous(breaks = seq(0,9, by = 3))\nplotcorrs_ggplot_family_sequences\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n#ggsave(\"plotcorrs_ggplot_family_sequences.pdf\", plotcorrs_ggplot_family_sequences, width = 10, height = 8, units = \"cm\")\n\n# Summarize for panel C\nplotcorrs_summary &lt;- plotcorrs %&gt;% dplyr::summarize(sumP6sequences = sum(p6seqcount))\nplotcorrs_summary\n\n  sumP6sequences\n1         155211\n\n\n\n# Family count by species: Panel D\nplotcorrs_ggplot_family_sequencespecies &lt;- ggplot(\n  plotcorrs, aes(x=log(ITISfamcount), y=log(p6speccount))) + \n  geom_point(pch = 1) + \n  theme_classic() + \n  xlab(\"Log of ITIS family count\") + \n  ylab(\"Log of trnL-P6 species count\") + \n  geom_abline(intercept = 0, slope = 1, color = \"black\", linewidth = 1, linetype = \"dashed\") + \n  geom_smooth(method = \"lm\", se=FALSE, linewidth=1, color = \"darkgreen\")  +\n  scale_y_continuous(breaks = seq(0,9, by = 3)) + \n  scale_x_continuous(breaks = seq(0,9, by = 3))\nplotcorrs_ggplot_family_sequencespecies         \n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n#ggsave(\"plotcorrs_ggplot_family_sequencespecies.pdf\", plotcorrs_ggplot_family_sequencespecies, width = 10, height = 8, units = \"cm\")\n\n# Summarize for panel D\nplotcorrs_summary &lt;- plotcorrs %&gt;% summarize(sump6speccount = sum(p6speccount))\nplotcorrs_summary\n\n  sump6speccount\n1          69873",
    "crumbs": [
      "Taxonomic coverage",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Correlations between plant species and DNA barcode availability</span>"
    ]
  },
  {
    "objectID": "geocov_ynp_selected.html",
    "href": "geocov_ynp_selected.html",
    "title": "Continent-scale barcode coverage of lodgepole pine and big sagebrush",
    "section": "",
    "text": "Figure 2A-B. Get species keys for maps of Pinus contorta and Artemisia tridentata occurrences.\nThis notebook will pull specimen records for two selected examples to highlight the effect of local sampling on global coverage.\nNOTE: Make sure GDAL is installed on the system you are running the notebooks from. This may require setting the “PROJ_LIB” and “GDAL_HOME” environment variables for your system.\n# Using t.mean raster layer created above with worldclim: Change t.mean so that all cells have zero values \n\nt.mean.files &lt;- list.files(\"../data/wc2.1_10m_tavg/\", \".tif\", full.names=TRUE)\n\nt.mean.files &lt;- list.files(\"../data/wc2.1_10m_tavg/\", \".tif\", full.names=TRUE)\nt.mean &lt;- terra::rast(t.mean.files)\nt.mean &lt;- terra::app(t.mean, fun = mean, na.rm = TRUE)\nt.mean.addvalues &lt;- t.mean\nt.mean.addvalues[!is.na(terra::values(t.mean.addvalues))] &lt;- 0\nterra::plot(t.mean.addvalues)\n\n\n\n\n\n\n\nstr(t.mean.addvalues)\n\nS4 class 'SpatRaster' [package \"terra\"]\n\n#terra::plot(t.mean.addvalues) \nt.mean.addvalues\n\nclass       : SpatRaster \ndimensions  : 1080, 2160, 1  (nrow, ncol, nlyr)\nresolution  : 0.1666667, 0.1666667  (x, y)\nextent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsource(s)   : memory\nname        : mean \nmin value   :    0 \nmax value   :    0 \n\nt.mean.addvalues_extent_use &lt;- terra::ext(t.mean.addvalues)\n# Get taxon keys from GBIF\nkey_artemisia_tridentata &lt;- name_suggest(q='Artemisia tridentata', rank='species')\nkey_artemisia_tridentata\n\nRecords returned [2] \nNo. unique hierarchies [0] \nArgs [q=Artemisia tridentata, limit=100, rank=species, fields1=key,\n     fields2=canonicalName, fields3=rank] \n# A tibble: 2 × 3\n      key canonicalName        rank   \n    &lt;int&gt; &lt;chr&gt;                &lt;chr&gt;  \n1 9396703 Artemisia tridentata SPECIES\n2 3121335 Artemisia tridentata SPECIES\n\nkey_pinus_contorta &lt;- name_suggest(q='Pinus contorta', rank='species')\nkey_pinus_contorta\n\nRecords returned [4] \nNo. unique hierarchies [0] \nArgs [q=Pinus contorta, limit=100, rank=species, fields1=key,\n     fields2=canonicalName, fields3=rank] \n# A tibble: 4 × 3\n      key canonicalName           rank   \n    &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt;  \n1 5285750 Pinus contorta          SPECIES\n2 8405446 Pinus contorta          SPECIES\n3 7617264 Pinus contorta          SPECIES\n4 3908060 Lupinus pinus-contortae SPECIES",
    "crumbs": [
      "Case-study -- Yellowstone",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Continent-scale barcode coverage of lodgepole pine and big sagebrush</span>"
    ]
  },
  {
    "objectID": "geocov_ynp_selected.html#figure-2a-map-of-pinus-contorta-gbif-records",
    "href": "geocov_ynp_selected.html#figure-2a-map-of-pinus-contorta-gbif-records",
    "title": "Continent-scale barcode coverage of lodgepole pine and big sagebrush",
    "section": "Figure 2A: Map of Pinus contorta GBIF records",
    "text": "Figure 2A: Map of Pinus contorta GBIF records\n\n# Use occ_search() to query gbif records \nPINCON_occurrences_2 &lt;- occ_search(taxonKey = 5285750, limit = 50000) # number found: 41,033\nhead(PINCON_occurrences_2, 2)\n\n$meta\n$meta$offset\n[1] 42000\n\n$meta$limit\n[1] 50\n\n$meta$endOfRecords\n[1] FALSE\n\n$meta$count\n[1] 42063\n\n\n$hierarchy\n$hierarchy[[1]]\n            name     key    rank\n1        Plantae       6 kingdom\n2   Tracheophyta 7707728  phylum\n3      Pinopsida     194   class\n4        Pinales     640   order\n5       Pinaceae    3925  family\n6          Pinus 2684241   genus\n7 Pinus contorta 5285750 species\n\n# Count matches: 15336\nPINCON_occurrences_2_df &lt;- data.frame(PINCON_occurrences_2$data) \n\n\n# Obtain coordinate data and project to desired CRS \nPinusSP &lt;- data.frame(x_coords = PINCON_occurrences_2_df$decimalLongitude, y_coords = PINCON_occurrences_2_df$decimalLatitude) \nhead(PinusSP, 2)\n\n   x_coords y_coords\n1 -123.9814 49.15059\n2 -117.5496 48.30912\n\nPinusSP &lt;- terra::vect(PinusSP, geom=c(\"x_coords\", \"y_coords\"), crs=\"epsg:4326\")  # WGS84\nhead(PinusSP, 2)\n\ndata frame with 0 columns and 0 rows\n\n# Check objects for plotting\nhead(t.mean.addvalues, 2)\n\n  mean\n1   NA\n2   NA\n\nPinusSP_raster &lt;- t.mean.addvalues\n\n# Extract cell numbers where coordinates match\nmatching_cells &lt;- terra::cellFromXY(PinusSP_raster, terra::crds(PinusSP))\n\n# Set the values in PinusSP_raster to 1 where coordinates match\nPinusSP_raster[matching_cells] &lt;- 1\nhead(PinusSP_raster, 2)\n\n  mean\n1    1\n2   NA\n\nterra::plot(PinusSP_raster)\n\n\n\n\n\n\n\nPinusSP_raster_dfpoints &lt;- terra::as.points(PinusSP_raster)\n\n# Convert to data frame\nPinusSP_raster_df &lt;- as.data.frame(PinusSP_raster_dfpoints, geom=\"XY\")\nhead(PinusSP_raster_df, 2)\n\n  mean          x        y\n1    1 -179.91667 89.91667\n2    0  -38.91667 83.58333\n\n\n\n# Plot using ggplot \nPinusSP_raster_df &lt;- PinusSP_raster_df[PinusSP_raster_df$mean &gt; 0, ]\n#PinusSP_raster_df\n\n# ggplot wrapper for world map \nworld_map &lt;- map_data(\"world\") #ggplot wrapper of map()\nnorth_america_map &lt;- subset(world_map, region == \"Mexico\" | region == \"Canada\" | region == \"USA\")\nhead(north_america_map, 2)\n\n           long      lat group order region    subregion\n14759 -59.78760 43.93960   245 14759 Canada Sable Island\n14760 -59.92227 43.90391   245 14760 Canada Sable Island\n\n#Yellowstone outline\naoi_boundary_YNP &lt;- sf::st_read(\"../data/YellowstonePark/YellowstonePark1995.shp\")\n\nReading layer `YellowstonePark1995' from data source \n  `/Users/tdivoll/Projects/Kartzinel/MolEco-MEC-24-1288/data/YellowstonePark/YellowstonePark1995.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1 feature and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 469695.4 ymin: -12706.41 xmax: 573531.9 ymax: 96658.52\nProjected CRS: NAD83 / Montana\n\naoi_boundary_YNP #examine features\n\nSimple feature collection with 1 feature and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 469695.4 ymin: -12706.41 xmax: 573531.9 ymax: 96658.52\nProjected CRS: NAD83 / Montana\n        AREA PERIMETER AB67_ AB67_ID                       geometry\n1 8842796032  447129.5     2     649 POLYGON ((559728.7 88811.52...\n\nst_crs(aoi_boundary_YNP) #check coordinate system \n\nCoordinate Reference System:\n  User input: NAD83 / Montana \n  wkt:\nPROJCRS[\"NAD83 / Montana\",\n    BASEGEOGCRS[\"NAD83\",\n        DATUM[\"North American Datum 1983\",\n            ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4269]],\n    CONVERSION[\"SPCS83 Montana zone (meter)\",\n        METHOD[\"Lambert Conic Conformal (2SP)\",\n            ID[\"EPSG\",9802]],\n        PARAMETER[\"Latitude of false origin\",44.25,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8821]],\n        PARAMETER[\"Longitude of false origin\",-109.5,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8822]],\n        PARAMETER[\"Latitude of 1st standard parallel\",49,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8823]],\n        PARAMETER[\"Latitude of 2nd standard parallel\",45,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8824]],\n        PARAMETER[\"Easting at false origin\",600000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8826]],\n        PARAMETER[\"Northing at false origin\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8827]]],\n    CS[Cartesian,2],\n        AXIS[\"easting (X)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"northing (Y)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Engineering survey, topographic mapping.\"],\n        AREA[\"United States (USA) - Montana - counties of Beaverhead; Big Horn; Blaine; Broadwater; Carbon; Carter; Cascade; Chouteau; Custer; Daniels; Dawson; Deer Lodge; Fallon; Fergus; Flathead; Gallatin; Garfield; Glacier; Golden Valley; Granite; Hill; Jefferson; Judith Basin; Lake; Lewis and Clark; Liberty; Lincoln; Madison; McCone; Meagher; Mineral; Missoula; Musselshell; Park; Petroleum; Phillips; Pondera; Powder River; Powell; Prairie; Ravalli; Richland; Roosevelt; Rosebud; Sanders; Sheridan; Silver Bow; Stillwater; Sweet Grass; Teton; Toole; Treasure; Valley; Wheatland; Wibaux; Yellowstone.\"],\n        BBOX[44.35,-116.07,49.01,-104.04]],\n    ID[\"EPSG\",32100]]\n\naoi_boundary_YNP_WGS84 &lt;- st_transform(aoi_boundary_YNP,CRS(\"+proj=longlat +datum=WGS84\")) #choose a projection and datum that every spatial object we add to the map will be converted to before plotting\nst_crs(aoi_boundary_YNP_WGS84) #check coordinate system to ensure projection worked\n\nCoordinate Reference System:\n  User input: GEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]] \n  wkt:\nGEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]]\n\naoi_boundary_YNP_WGS84 #re examine features\n\nSimple feature collection with 1 feature and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -111.1543 ymin: 44.13245 xmax: -109.8339 ymax: 45.10785\nGeodetic CRS:  GEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]]\n        AREA PERIMETER AB67_ AB67_ID                       geometry\n1 8842796032  447129.5     2     649 POLYGON ((-110.0112 45.0478...\n\n\n\n#Plot \ncombtab &lt;- read.csv(\"../data/combtab.csv\")\ncombtab_Pincon &lt;- subset(combtab, species_name == \"Pinus contorta\")\naoi_boundary_YNP_WGS84_df &lt;- as.data.frame(aoi_boundary_YNP_WGS84, xy = TRUE)\npinusmap2 &lt;- ggplot() + \n  theme_classic() +\n  geom_tile(data = PinusSP_raster_df, aes(x, y, fill = mean)) + \n  geom_map(data = north_america_map, \n           map = north_america_map, \n           aes(map_id = region), fill = \"NA\", color = \"lightgray\", size = 0.2) + \n  scale_fill_viridis_c(na.value = \"white\", option = \"viridis\", direction = 1, begin =0.6) +\n  xlab(\"\") + ylab(\"\") + \n  scale_y_continuous(breaks = seq(-15, 75, 15), limits = c(20, 70)) +\n  scale_x_continuous(breaks = seq(-160, -60, 40), limits = c(-165, -50)) +\n  theme(legend.position = \"none\") +\n  geom_point(data = combtab_Pincon, \n             aes(x = lon, y = lat), pch = 3, size = 3, stroke = 0.9, color = alpha(\"black\", 0.9)) +\n  geom_sf(data = aoi_boundary_YNP_WGS84, fill = \"transparent\", lwd = 0.25, color = \"blue\")\npinusmap2\n\n\n\n\n\n\n\n#ggsave(\"pinusmap20240624_1.pdf\", pinusmap2, width = 20, height = 8, units = \"cm\")",
    "crumbs": [
      "Case-study -- Yellowstone",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Continent-scale barcode coverage of lodgepole pine and big sagebrush</span>"
    ]
  },
  {
    "objectID": "geocov_ynp_selected.html#figure-2b-map-of-artemisia-tridentata-gbif-records",
    "href": "geocov_ynp_selected.html#figure-2b-map-of-artemisia-tridentata-gbif-records",
    "title": "Continent-scale barcode coverage of lodgepole pine and big sagebrush",
    "section": "Figure 2B: Map of Artemisia tridentata gbif records",
    "text": "Figure 2B: Map of Artemisia tridentata gbif records\n\n# Use occ_search() to query GBIF records \nArtTri_occurrences_2 &lt;- occ_search(taxonKey = 9396703, limit = 20000) #16,738 found\nhead(ArtTri_occurrences_2, 2)\n\n$meta\n$meta$offset\n[1] 19800\n\n$meta$limit\n[1] 200\n\n$meta$endOfRecords\n[1] FALSE\n\n$meta$count\n[1] 20276\n\n\n$hierarchy\n$hierarchy[[1]]\n                  name     key    rank\n1              Plantae       6 kingdom\n2         Tracheophyta 7707728  phylum\n3        Magnoliopsida     220   class\n4            Asterales     414   order\n5           Asteraceae    3065  family\n6            Artemisia 3120641   genus\n7 Artemisia tridentata 9396703 species\n\n# Count matches\nArtTri_occurrences_df &lt;- data.frame(ArtTri_occurrences_2$data) \n\n\n# Obtain coordinate data and project to desired CRS \nArtemisiaSP &lt;- data.frame(x_coords = ArtTri_occurrences_df$decimalLongitude, y_coords = ArtTri_occurrences_df$decimalLatitude) \nhead(ArtemisiaSP, 2)\n\n   x_coords y_coords\n1 -112.2500 41.05834\n2 -112.2562 41.03242\n\nArtemisiaSP &lt;- subset(ArtemisiaSP, x_coords !=\"\")\n\nArtemisiaSP &lt;- terra::vect(ArtemisiaSP, geom=c(\"x_coords\", \"y_coords\"), crs=\"epsg:4326\")\n\n\n# Check objects for plotting\nhead(t.mean.addvalues, 2)\n\n  mean\n1   NA\n2   NA\n\nArtemisiaSP_raster &lt;- t.mean.addvalues\n\n# Extract cell numbers where coordinates match\nmatching_cells &lt;- terra::cellFromXY(ArtemisiaSP_raster, terra::crds(ArtemisiaSP))\n\n# Set the values in ArtemisiaSP_raster to 1 where coordinates match\nArtemisiaSP_raster[matching_cells] &lt;- 1\nhead(ArtemisiaSP_raster, 2)\n\n  mean\n1   NA\n2   NA\n\nterra::plot(ArtemisiaSP_raster)\n\n\n\n\n\n\n\nArtemisiaSP_raster_dfpoints &lt;- terra::as.points(ArtemisiaSP_raster)\n\n# Convert to data frame\nArtemisiaSP_raster_df &lt;- as.data.frame(ArtemisiaSP_raster_dfpoints, geom=\"XY\")\nhead(ArtemisiaSP_raster_df, 2)\n\n  mean         x        y\n1    0 -38.91667 83.58333\n2    0 -38.75000 83.58333\n\n\n\n# Plot using ggplot \nArtemisiaSP_raster_df &lt;- subset(ArtemisiaSP_raster_df, mean &gt; 0)\nhead(ArtemisiaSP_raster_df, 2)\n\n       mean         x        y\n207738    1 -122.0833 52.08333\n209104    1 -122.5833 51.91667\n\n#Plot\ncombtab_Arttri &lt;- subset(combtab, species_name == \"Artemisia tridentata\")\nArtemisiamap3 &lt;- ggplot() + \n  theme_classic() +\n  geom_tile(data = ArtemisiaSP_raster_df, aes(x, y, fill = mean)) + \n  geom_map(data = north_america_map, map = north_america_map, aes(map_id = region), fill = \"NA\", color = \"lightgray\", size = 0.2) + \n  scale_fill_viridis_c(na.value = \"white\", option = \"inferno\", direction = -1, begin = 0.5) +\n  xlab(\"\") + ylab(\"\") + \n   scale_y_continuous(breaks = seq(-15, 75, 15), limits = c(20, 70)) +\n  scale_x_continuous(breaks = seq(-160, -60, 40), limits = c(-165, -50)) +\n  theme(legend.position = \"none\") +\n  geom_point(data = combtab_Arttri, aes(x = lon, y = lat), pch = 8, size = 3, stroke = 0.9, color = alpha(\"black\", 0.9)) + geom_sf(data = aoi_boundary_YNP_WGS84, fill = \"transparent\", lwd = 0.25, color = \"blue\")\nArtemisiamap3\n\n\n\n\n\n\n\n#ggsave(\"Artemisiamap4_20240626_1.pdf\", Artemisiamap3, width = 20, height = 8, units = \"cm\")",
    "crumbs": [
      "Case-study -- Yellowstone",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Continent-scale barcode coverage of lodgepole pine and big sagebrush</span>"
    ]
  },
  {
    "objectID": "fetch_gbif.html",
    "href": "fetch_gbif.html",
    "title": "Fetching plant occurrence records from GBIF",
    "section": "",
    "text": "This notebook contains code used to pull plant species occurrence records from the GBIF API.\nWe use pacman to mange the R packages and load libraries.\n\n## First check for the required packages, install if needed, and load the libraries.\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\n\nBiocManager::install(\"sangerseqR\")\nremotes::install_github(\"ropensci/bold\")\n\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(dplyr, curl, zip, readr, rgbif, usethis, stringr)\n\n\nRead in BOLD species list and obtain GBIF keys\nThis block uses a site-specific list of species from the Yellowstone BOLD project to pull any taxon keys for those species hosted on GBIF, matched by exact scientific names.\nThe list of species we used can be accessed from Anderson and Hoff (2024), and filtered for trnL.\nSimilarly, and data from a BOLD project could be downloaded and used in this analysis to generate a similar map of global coverage from a localized sampling effort.\nThe data being read in for this block is data set S4 in the Supplement provided with the publication.\n\nspecies_list &lt;- readr::read_csv(\"../data/Kartzinel_et_al_Dataset_S4_20241030.csv\") %&gt;%\n  pull(\"Species\")\n\nRows: 570 Columns: 62\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (36): Project Code, Process ID, Sample ID, Field ID, rbcL Seq. Length, r...\ndbl  (7): rbcL Trace Count, matK Trace Count, trnL-F Trace Count, trnH-psbA ...\nlgl (19): BIN, Catalog Num, Image Count, Contamination, Stop Codon, Flagged ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n# Get all backbone results (without filtering)\nall_matches &lt;- name_backbone_checklist(species_list, kingdom = \"plants\")\n\nexact_key_matches &lt;- all_matches %&gt;%\n  filter(matchType == \"EXACT\") %&gt;%\n  select(usageKey) %&gt;%\n  as.list()\n\n# Find taxa that didn't match at species level.\nnot_exact_matches &lt;- all_matches %&gt;%\n  filter(matchType != \"EXACT\")\n\n\n\nInvestigate taxon keys for fuzzy matches and higher rank matches\nSome keys may indicate that local species are sharing a taxon key, or the keys returned were backed off to higher taxonomic levels. Beware that these can result in many more occurrence records matched at higher taxonomic levels. This can happen for hyper-local species with no occurrence records in GBIF. For our purposes, we kept only exact species matches.\n\n# View results\nnot_exact_matches\n\n# A tibble: 53 × 26\n   usageKey scientificName       canonicalName rank  status confidence matchType\n      &lt;int&gt; &lt;chr&gt;                &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;    \n 1  3033620 Pulsatilla Mill.     Pulsatilla    GENUS ACCEP…         99 HIGHERRA…\n 2  2704858 Calamagrostis Adans. Calamagrostis GENUS ACCEP…         96 HIGHERRA…\n 3     3064 Amaranthaceae        Amaranthaceae FAMI… ACCEP…         99 HIGHERRA…\n 4  3171742 Erythranthe Spach    Erythranthe   GENUS ACCEP…         99 HIGHERRA…\n 5  8148051 Bistorta (L.) Scop.  Bistorta      GENUS ACCEP…         99 HIGHERRA…\n 6  8148051 Bistorta (L.) Scop.  Bistorta      GENUS ACCEP…         99 HIGHERRA…\n 7  8148051 Bistorta (L.) Scop.  Bistorta      GENUS ACCEP…         99 HIGHERRA…\n 8       NA &lt;NA&gt;                 &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          100 NONE     \n 9       NA &lt;NA&gt;                 &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          100 NONE     \n10       NA &lt;NA&gt;                 &lt;NA&gt;          &lt;NA&gt;  &lt;NA&gt;          100 NONE     \n# ℹ 43 more rows\n# ℹ 19 more variables: kingdom &lt;chr&gt;, phylum &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;,\n#   genus &lt;chr&gt;, species &lt;chr&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;,\n#   classKey &lt;int&gt;, orderKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;,\n#   speciesKey &lt;int&gt;, synonym &lt;lgl&gt;, class &lt;chr&gt;, acceptedUsageKey &lt;int&gt;,\n#   verbatim_name &lt;chr&gt;, verbatim_index &lt;dbl&gt;, verbatim_kingdom &lt;chr&gt;\n\n\nWe had 6 species that did not match a species key, resulting in 98% of the species having data we can use from GBIF to explore global geographic coverage of these species.\n\n\nSet GBIF credentials\nThe following block will open your .Renviron file. Register an account with GBIF on their website and then add these environment variables to the .Renviron and save: GBIF_USER=“user” GBIF_PWD=“password” GBIF_EMAIL=“email”.\nAfter requesting the data based on our list of taxon keys, we will get millions of occurrence records that we can download; the data will be help in your GBIF portal.\n\nusethis::edit_r_environ()\n\n☐ Edit '/Users/tdivoll/.Renviron'.\n\n\n☐ Restart R for changes to take effect.\n\n\n\n\nRequest the occurrence data\nWe’ll further restrict the data returned to records that have reliable coordinate data, and use a simple CSV format to reduce the size of the data. The Darwin Core Archive format will include much more metadata, but we’re only interested in the locations for this analysis.\n\ngbif_data_BOLDlist &lt;- occ_download(\n  pred_in(\"taxonKey\", exact_key_matches$usageKey),\n  pred(\"hasCoordinate\", TRUE),\n  pred(\"hasGeospatialIssue\", FALSE),\n  format = \"SIMPLE_CSV\"\n)\n\n\n\nGet metadata and wait\nGet the metadata about the request.\n\ngbif_data_BOLDlist # this will print some info, including the download ID we need to check on the job\n\n&lt;&lt;gbif download&gt;&gt;\n  Your download is being processed by GBIF:\n  https://www.gbif.org/occurrence/download/0007289-250127130748423\n  Most downloads finish within 15 min.\n  Check status with\n  occ_download_wait('0007289-250127130748423')\n  After it finishes, use\n  d &lt;- occ_download_get('0007289-250127130748423') %&gt;%\n    occ_download_import()\n  to retrieve your download.\nDownload Info:\n  Username: tdivoll\n  E-mail: timothy_divoll@brown.edu\n  Format: SIMPLE_CSV\n  Download key: 0007289-250127130748423\n  Created: 2025-02-01T12:16:59.420+00:00\nCitation Info:  \n  Please always cite the download DOI when using this data.\n  https://www.gbif.org/citation-guidelines\n  DOI: 10.15468/dl.7bdmx3\n  Citation:\n  GBIF Occurrence Download https://doi.org/10.15468/dl.7bdmx3 Accessed from R via rgbif (https://github.com/ropensci/rgbif) on 2025-02-01\n\n\nCheck the status of the download.\n\nocc_download_wait('0066939-241126133413365')\n\nstatus: succeeded\n\n\ndownload is done, status: succeeded\n\n\n&lt;&lt;gbif download metadata&gt;&gt;\n  Status: SUCCEEDED\n  DOI: 10.15468/dl.48qedg\n  Format: SIMPLE_CSV\n  Download key: 0066939-241126133413365\n  Created: 2025-01-13T17:50:02.365+00:00\n  Modified: 2025-01-13T18:02:18.702+00:00\n  Download link: https://api.gbif.org/v1/occurrence/download/request/0066939-241126133413365.zip\n  Total records: 20510078\n\n\n\n\n\n\nAnderson, Segal, H. M., and H. K Hoff. 2024. “Plant DNA Barcode Data of 572 Specimens from Yellowstone National Park.” BOLD Systems. https://doi.org/10.5883/DS-YNPBPR2.",
    "crumbs": [
      "Case-study -- Yellowstone",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Fetching plant occurrence records from GBIF</span>"
    ]
  },
  {
    "objectID": "build_geocov_map.html",
    "href": "build_geocov_map.html",
    "title": "Mapping global coverage from local sampling",
    "section": "",
    "text": "Convert 18.5 Mil records into H3 hex shapes\nImport the records once the download is finished; this could take a while on a slow connection.\nInspect the lat/long values.\nFilter out points at the edges of flat map, they are causes some stretching issues when building hex bins.\nWe use the Uber H3 hexagon system for binning records into spatial areas to plot densities.",
    "crumbs": [
      "Case-study -- Yellowstone",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Mapping global coverage from local sampling</span>"
    ]
  },
  {
    "objectID": "build_geocov_map.html#convert-18.5-mil-records-into-h3-hex-shapes",
    "href": "build_geocov_map.html#convert-18.5-mil-records-into-h3-hex-shapes",
    "title": "Mapping global coverage from local sampling",
    "section": "",
    "text": "Convert df to sf\n\ndata_sf &lt;- st_as_sf(x = data2,                         \n           coords = c(\"decimalLongitude\", \"decimalLatitude\"),\n           crs = 4326)\n\n\n\nCheck # of species vs # of scientific name\n\ncat(length(unique(data_sf$scientificName)), length(unique(data_sf$species)), length(unique(data_sf$taxonKey)), length(unique(data_sf$speciesKey)))\n\n3941 311 3941 311\n\n\n\nspecies &lt;- as.data.frame(unique(data_sf$species))\nspecies\n\n          unique(data_sf$species)\n1                  Holcus lanatus\n2                Senecio vulgaris\n3            Hypochaeris radicata\n4            Achillea millefolium\n5            Agrostis stolonifera\n6              Juncus articulatus\n7               Prunella vulgaris\n8      Chamaenerion angustifolium\n9           Deschampsia cespitosa\n10              Spergularia rubra\n11               Trifolium repens\n12               Ranunculus acris\n13          Ranunculus sceleratus\n14          Eleocharis acicularis\n15                  Festuca rubra\n16           Phalaris arundinacea\n17                Phleum pratense\n18                  Sonchus asper\n19           Eleocharis palustris\n20                  Poa pratensis\n21                   Rubus idaeus\n22               Sonchus arvensis\n23          Potamogeton gramineus\n24              Cerastium arvense\n25                Carex canescens\n26                 Galium boreale\n27             Juniperus communis\n28              Tragopogon dubius\n29                Bromus tectorum\n30                 Erigeron acris\n31                Thlaspi arvense\n32         Campanula rotundifolia\n33            Onopordum acanthium\n34             Limosella aquatica\n35          Asparagus officinalis\n36             Veronica peregrina\n37             Koeleria macrantha\n38                  Poa palustris\n39               Dianthus armeria\n40            Solidago canadensis\n41             Alyssum alyssoides\n42            Lepidium virginicum\n43               Myosurus minimus\n44           Allium schoenoprasum\n45                Euphorbia esula\n46              Chondrilla juncea\n47                 Bromus inermis\n48           Potentilla norvegica\n49            Xanthium strumarium\n50                Agrostis scabra\n51                   Carex limosa\n52                     Poa alpina\n53                 Phleum alpinum\n54             Astragalus alpinus\n55             Myosotis alpestris\n56              Eritrichium nanum\n57            Potentilla argentea\n58                Alyssum simplex\n59                  Oxyria digyna\n60              Sagina saginoides\n61            Anthoxanthum nitens\n62              Bromus squarrosus\n63            Dasiphora fruticosa\n64            Persicaria amphibia\n65                   Viola adunca\n66           Collinsia parviflora\n67               Agrostis exarata\n68            Lepidium appelianum\n69            Erythranthe lewisii\n70       Ranunculus eschscholtzii\n71          Hesperochiron pumilus\n72          Maianthemum racemosum\n73                   Actaea rubra\n74       Lithophragma parviflorum\n75                   Acer glabrum\n76           Aconitum columbianum\n77           Taraxacum officinale\n78            Populus tremuloides\n79            Fragaria virginiana\n80             Iris missouriensis\n81           Aquilegia flavescens\n82              Sedum lanceolatum\n83                 Mahonia repens\n84        Polemonium pulcherrimum\n85       Ceratocephala orthoceras\n86       Spiranthes romanzoffiana\n87           Ranunculus uncinatus\n88             Veronica americana\n89                 Allium cernuum\n90           Platanthera dilatata\n91        Ranunculus alismifolius\n92                 Elymus glaucus\n93                Viola nuttallii\n94                Neottia cordata\n95              Wyethia sagittata\n96                  Linum lewisii\n97         Geranium viscosissimum\n98               Carex duriuscula\n99            Agropyron cristatum\n100              Phlox longifolia\n101            Lysimachia ciliata\n102              Bromus japonicus\n103        Sporobolus cryptandrus\n104             Festuca octoflora\n105                Elymus smithii\n106             Danthonia spicata\n107          Sphaeralcea coccinea\n108          Equisetum laevigatum\n109             Tamarix chinensis\n110              Bromus carinatus\n111              Elymus elymoides\n112           Hesperostipa comata\n113             Plantago elongata\n114        Polygonum ramosissimum\n115       Castilleja linariifolia\n116             Glyceria borealis\n117      Calamagrostis canadensis\n118         Geranium richardsonii\n119       Pseudoroegneria spicata\n120         Schoenoplectus acutus\n121              Boechera stricta\n122           Camelina microcarpa\n123               Hordeum jubatum\n124           Gayophytum diffusum\n125           Potentilla hippiana\n126           Polygonum douglasii\n127         Eleocharis rostellata\n128          Torreyochloa pallida\n129             Collomia linearis\n130              Elymus violaceus\n131                Pinus contorta\n132                Rumex fueginus\n133  Schoenoplectus subterminalis\n134        Androsace occidentalis\n135            Descurainia incana\n136       Delphinium nuttallianum\n137          Eriogonum umbellatum\n138     Androsace septentrionalis\n139                Carex obtusata\n140          Senecio triangularis\n141         Beckmannia syzigachne\n142      Taraxacum erythrospermum\n143                    Poa glauca\n144              Koeleria spicata\n145        Taraxacum ceratophorum\n146                Phlox gracilis\n147         Scolochloa festucacea\n148               Salvia nemorosa\n149             Anemone multifida\n150     Deschampsia danthonioides\n151                   Poa secunda\n152          Penstemon fruticosus\n153                  Packera cana\n154           Potentilla gordonii\n155               Carex vallicola\n156         Veronica wormskjoldii\n157        Delphinium occidentale\n158      Symphyotrichum ascendens\n159             Lupinus argenteus\n160   Leptosiphon septentrionalis\n161       Puccinellia nuttalliana\n162   Symphyotrichum bracteolatum\n163          Erigeron caespitosus\n164          Helianthus nuttallii\n165            Carex pachystachya\n166      Symphyotrichum foliaceum\n167                Geum triflorum\n168             Oxytropis sericea\n169                Carex simulata\n170             Mertensia ciliata\n171          Festuca brachyphylla\n172            Eremogone congesta\n173             Penstemon deustus\n174             Rumex paucifolius\n175         Helianthella uniflora\n176              Astragalus miser\n177        Eriogonum heracleoides\n178          Tetradymia canescens\n179                  Carex rossii\n180             Carex brunnescens\n181            Erigeron glabellus\n182        Calochortus eurycarpus\n183           Astragalus agrestis\n184                Carex petasata\n185                  Poa cusickii\n186          Lomatium triternatum\n187       Chenopodiastrum simplex\n188        Polemonium occidentale\n189         Castilleja rhexifolia\n190                Carex disperma\n191              Erigeron pumilus\n192        Antennaria microphylla\n193               Agoseris glauca\n194       Scrophularia lanceolata\n195            Castilleja miniata\n196        Plagiobothrys scouleri\n197            Astragalus purshii\n198            Taraxia subacaulis\n199              Stenotus acaulis\n200          Eremopyrum triticeum\n201          Boechera retrofracta\n202               Leymus cinereus\n203         Micranthes rhomboidea\n204              Phlox multiflora\n205          Eriocoma lettermanii\n206         Alyssum turkestanicum\n207          Cherleria obtusiloba\n208             Senecio crassulus\n209            Carex chalciolepis\n210               Carex elynoides\n211         Clematis hirsutissima\n212           Heterotheca villosa\n213                     Poa arida\n214               Draba albertina\n215        Polygonum polygaloides\n216          Lomatium macrocarpum\n217             Iliamna rivularis\n218            Carex praegracilis\n219                Draba nemorosa\n220          Danthonia intermedia\n221          Penstemon attenuatus\n222             Castilleja pilosa\n223            Festuca idahoensis\n224            Penstemon procerus\n225               Veronica biloba\n226         Epilobium hornemannii\n227             Myosurus apetalus\n228             Draba oligosperma\n229                  Poa interior\n230             Crepis modocensis\n231            Orthocarpus luteus\n232   Drymocallis pseudorupestris\n233      Toxicoscordion venenosum\n234              Eriogonum flavum\n235              Carex raynoldsii\n236          Erigeron ochroleucus\n237             Draba crassifolia\n238             Penstemon cyaneus\n239              Elymus scribneri\n240             Carex spectabilis\n241        Chenopodium atrovirens\n242         Saxifraga bronchialis\n243         Solidago multiradiata\n244                   Poa reflexa\n245         Eriogonum caespitosum\n246       Stephanomeria runcinata\n247               Carex filifolia\n248             Geum macrophyllum\n249     Muhlenbergia richardsonis\n250                Festuca kingii\n251          Castilleja pulchella\n252    Calamagrostis purpurascens\n253           Erigeron corymbosus\n254       Thalictrum sparsiflorum\n255        Thalictrum occidentale\n256         Epilobium lactiflorum\n257                Glyceria elata\n258                Carex parryana\n259         Oreocarya spiculifera\n260      Fritillaria atropurpurea\n261               Lactuca biennis\n262            Allium brevistylum\n263             Boechera lemmonii\n264        Muhlenbergia glomerata\n265                 Draba globosa\n266                 Poa leptocoma\n267         Wyethia helianthoides\n268              Carex haydeniana\n269                Carex paysonis\n270          Claytonia multiscapa\n271              Opuntia fragilis\n272             Carex leporinella\n273               Ionactis alpina\n274             Eriocoma nelsonii\n275      Symphyotrichum campestre\n276                  Carex hoodii\n277            Taraxia breviflora\n278              Carex neurophora\n279             Arabis pycnocarpa\n280           Ceanothus velutinus\n281           Parnassia fimbriata\n282                 Silene parryi\n283           Heuchera cylindrica\n284              Dryas octopetala\n285        Scheuchzeria palustris\n286        Synthyris wyomingensis\n287      Telesonix heucheriformis\n288           Heuchera parviflora\n289                    Draba cana\n290         Calamagrostis stricta\n291            Polygonum achoreum\n292                 Draba incerta\n293               Carex tahoensis\n294               Ventenata dubia\n295 Pedicularis cystopteridifolia\n296       Castilleja crista-galli\n297        Conimitella williamsii\n298                Bromus porteri\n299           Hieracium praealtum\n300               Filago arvensis\n301          Matricaria discoidea\n302           Blitum nuttallianum\n303               Koeleria vaseyi\n304                Draba praealta\n305              Arabis nuttallii\n306             Mimulus moschatus\n307             Physaria reediana\n308         Eriocoma richardsonii\n309              Carex stenoptila\n310         Ranunculus mongolicus\n311              Castilleja nivea\n\n\nGet CRS info.\n\nraster::crs(data_sf)\n\n[1] \"GEOGCRS[\\\"WGS 84\\\",\\n    ENSEMBLE[\\\"World Geodetic System 1984 ensemble\\\",\\n        MEMBER[\\\"World Geodetic System 1984 (Transit)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G730)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G873)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1150)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1674)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1762)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G2139)\\\"],\\n        ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        ENSEMBLEACCURACY[2.0]],\\n    PRIMEM[\\\"Greenwich\\\",0,\\n        ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    CS[ellipsoidal,2],\\n        AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n            ORDER[1],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n            ORDER[2],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    USAGE[\\n        SCOPE[\\\"Horizontal component of 3D system.\\\"],\\n        AREA[\\\"World.\\\"],\\n        BBOX[-90,-180,90,180]],\\n    ID[\\\"EPSG\\\",4326]]\"\n\n\nThis step pairs lat long into a point geometry.\n\nst_transform(data_sf, 4326)\n\nSimple feature collection with 20503896 features and 6 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -174.9518 ymin: -55.04704 xmax: 175 ymax: 84.75\nGeodetic CRS:  WGS 84\n# A tibble: 20,503,896 × 7\n   scientificName          species         taxonKey speciesKey  year countryCode\n * &lt;chr&gt;                   &lt;chr&gt;              &lt;int&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;      \n 1 Holcus lanatus L.       Holcus lanatus   2706164    2706164  2018 FR         \n 2 Holcus lanatus L.       Holcus lanatus   2706164    2706164  2018 FR         \n 3 Senecio vulgaris L.     Senecio vulgar…  3108983    3108983  1985 FR         \n 4 Hypochaeris radicata L. Hypochaeris ra…  3093702    3093702  2019 FR         \n 5 Achillea millefolium L. Achillea mille…  3120060    3120060  2015 FR         \n 6 Agrostis stolonifera L. Agrostis stolo…  2706435    2706435  1994 FR         \n 7 Achillea millefolium L. Achillea mille…  3120060    3120060  2000 FR         \n 8 Senecio vulgaris L.     Senecio vulgar…  3108983    3108983  2009 FR         \n 9 Juncus articulatus L.   Juncus articul…  2701261    2701261  1991 FR         \n10 Prunella vulgaris L.    Prunella vulga…  5341297    5341297  1999 FR         \n# ℹ 20,503,886 more rows\n# ℹ 1 more variable: geometry &lt;POINT [°]&gt;\n\n\nToss records without a species assigned and randomly subsample per species.\n\ndata_sf &lt;- data_sf %&gt;%\n  filter(species != \"\") %&gt;%\n  group_by(species) %&gt;%\n  #slice_sample(n = params$random_sample_n) # number of samples\n  slice_sample(prop = params$random_sample_prop) # proportion of samples\n\nMake a point for the centroid of YNP (middle of Yellowstone Lake), to use for distance calculations.\n\nYNP_centroid &lt;- st_point(c(-110.40, 44.45)) %&gt;%\n  st_coordinates() %&gt;%\n  as.data.frame() %&gt;%\n  st_as_sf(coords = c(\"X\", \"Y\"), crs = 4326)\n\nusa = st_as_sf(map('state', plot = FALSE, fill = TRUE))\n\nggplot() + \n  geom_sf(data = usa) +\n  geom_sf(data = YNP_centroid, aes(geometry=geometry), pch = 19, color = 'darkturquoise')\n\n\n\n\n\n\n\n\nThis block will calculate the distances from the center of Yellowstone for each row in the dataset.\n\ntic()\n data_sf &lt;- data_sf %&gt;%\n  mutate(\n    dist = st_distance(geometry, YNP_centroid) %&gt;%\n  set_units(\"km\"))\nbeep(2)\ntoc()\n\n91.123 sec elapsed\n\n\n\n\nSummarize the distances to get a count, average distance, and sd of distance for each species.\nThis will output a dataframe where each row in one of the 279 species with occurrence records in GBIF. The geometries are also merged to a multipoint so a minimum convex polygon for a single species could be plotted easily.\n\ntic()\nspecies_dist &lt;- data_sf %&gt;%\n  group_by(species) %&gt;%\n  summarise(\n    count = n(),\n    min_dist = min(dist),\n    max_dist = max(dist),\n    mean_dist = mean(dist),\n    sd_dist = sd(dist)\n  )\nbeep(2)\nsummary(species_dist)\n\n   species              count            min_dist           max_dist    \n Length:311         Min.   :     26   Min.   :   1.268   Min.   :  174  \n Class :character   1st Qu.:   1083   1st Qu.:  12.825   1st Qu.: 3099  \n Mode  :character   Median :   3751   Median :  31.953   Median : 8666  \n                    Mean   :  65929   Mean   :  61.950   Mean   : 8562  \n                    3rd Qu.:  15874   3rd Qu.:  53.920   3rd Qu.:12698  \n                    Max.   :1392917   Max.   :5688.516   Max.   :19489  \n   mean_dist         sd_dist                 geometry  \n Min.   : 108.5   Min.   :  30.38   MULTIPOINT   :311  \n 1st Qu.: 710.5   1st Qu.: 328.71   epsg:4326    :  0  \n Median :1068.3   Median : 786.85   +proj=long...:  0  \n Mean   :2889.7   Mean   :1124.93                      \n 3rd Qu.:6019.3   3rd Qu.:1576.01                      \n Max.   :8737.6   Max.   :5122.90                      \n\ntoc()\n\n628.331 sec elapsed\n\n\nOutput a file with summary data about distances!\n\nspecies_dist %&gt;%\n  st_drop_geometry() %&gt;%\n  write.csv(\"./distance_from_YNP_by_species.csv\")\n\nUse this to get a few CRS codes to try for projection if things look off.\n\nsuggest_crs(data_sf)\n\n# A tibble: 10 × 6\n   crs_code crs_name                        crs_type crs_gcs crs_units crs_proj4\n   &lt;chr&gt;    &lt;chr&gt;                           &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;    \n 1 6931     WGS 84 / NSIDC EASE-Grid 2.0 N… project…    4326 m         +proj=la…\n 2 3395     WGS 84 / World Mercator         project…    4326 m         +proj=me…\n 3 3857     WGS 84 / Pseudo-Mercator        project…    4326 m         +proj=me…\n 4 6933     WGS 84 / NSIDC EASE-Grid 2.0 G… project…    4326 m         +proj=ce…\n 5 3832     WGS 84 / PDC Mercator           project…    4326 m         +proj=me…\n 6 6932     WGS 84 / NSIDC EASE-Grid 2.0 S… project…    4326 m         +proj=la…\n 7 8903     RGWF96 / UTM zone 1S            project…    8900 m         +proj=ut…\n 8 3576     WGS 84 / North Pole LAEA Russia project…    4326 m         +proj=la…\n 9 3575     WGS 84 / North Pole LAEA Europe project…    4326 m         +proj=la…\n10 3574     WGS 84 / North Pole LAEA Atlan… project…    4326 m         +proj=la…\n\n\nPull geospatial hex locations for each point set.\n\ndata_sf$h3_index &lt;- geo_to_h3(data_sf, params$resolution) \n\nGroup by hex bin and count species in each one.\n\n# Check that the number of unique bins is much less than the number of rows\nlength(unique(data_sf$h3_index))\n\n[1] 7426\n\ndata_sf2 &lt;- data_sf %&gt;%\n  group_by(h3_index) %&gt;%\n  summarise(distinct_species = n_distinct(species))\nbeep(2)\n\nCount the number of records in each hex bin.\n\nhex_freq &lt;- as.data.frame(table(data_sf2$h3_index))\n\nGet the coordinates of of each hex bin.\n\ndata_hex &lt;- h3_to_geo_boundary_sf(data_sf2$h3_index)\n\nMerge the bin coords with frequency data for plotting.\n\nplot_data &lt;- merge(as.data.frame(data_sf2), data_hex, by=\"h3_index\")\n\nReport out the number of hexagons, and the min and max number of species in any one hex.\n\ncat(length(unique(plot_data$h3_index)), min(plot_data$distinct_species), max(plot_data$distinct_species))\n\n7426 1 276\n\n\nBuild the map\n\nworldmap &lt;- ne_countries(scale = 'large', returnclass = 'sf')\n\n\nggplot() + \n  geom_sf(data = worldmap$geometry) +\n  geom_sf(data = plot_data, aes(geometry = geometry.y, fill=distinct_species)) +\n  scale_fill_viridis_c(option=\"turbo\") +\n  ggtitle(\"Count of species in each cell\") +\n  theme_classic() + theme(legend.title = element_blank()) \n\n\n\n\n\n\n\nggsave(\"BOLD_GBIF_12400km2.png\") # uncomment to save a copy\n\nSaving 7 x 5 in image",
    "crumbs": [
      "Case-study -- Yellowstone",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Mapping global coverage from local sampling</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Anderson, Segal, H. M., and H. K Hoff. 2024. “Plant DNA Barcode\nData of 572 Specimens from Yellowstone National Park.” BOLD\nSystems. https://doi.org/10.5883/DS-YNPBPR2.\n\n\nFick, S. E., and R. J. Hijmans. 2017. “WorldClim 2: New 1km\nSpatial Resolution Climate Surfaces for Global Land Areas” 37:\n4302–15. https://doi.org/10.1002/joc.5086.",
    "crumbs": [
      "References"
    ]
  }
]