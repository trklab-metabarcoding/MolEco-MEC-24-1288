{
  "hash": "744370831c3eeb68edb143be66540697",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Coverage by climatic zones\"\nformat: html\n---\n\n\n\n\nThis notebook will generate plots of geographic coverage of barcodes available on BOLD, in relation to climatic zones, and for several genetic markers. It also assesses contributions to BOLD by Project ID.\n\nWe trim dataframe outputs to the first two rows for demonstration, but full dataframes will be generated and stored in the R environment when running the code from source.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## First check for the required packages, install if needed, and load the libraries.\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\n\nBiocManager::install(\"sangerseqR\")\nremotes::install_github(\"ropensci/bold\")\nremotes::install_github(\"ropensci/taxize\")\n\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(maps, ggplot2, countrycode, rgbif, data.table, raster, mapproj, sf)\n```\n:::\n\n\n\n\n# Figure 1. Read in combtab dataset of global barcode data from BOLD and summarize.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombtab <- read.csv(\"../data/BoldPhyla_to_Families_combtab_v4.csv\")\n#View(combtab_20240624)\n\ncombtab_2 <- (unique(combtab$family_name))\nhead(combtab_2, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Acanthaceae\" \"Achariaceae\"\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(unique(combtab$family_name), 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Acanthaceae\" \"Achariaceae\"\n```\n\n\n:::\n\n```{.r .cell-code}\ncombtab_subset_barcodes <- combtab %>% subset(multi != \"---\" & multi != \"\")\nhead(combtab_subset_barcodes, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA                     415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA                \n2        632816          Ruellia inflata               NA                \n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA                          NA\n2                   NA                 NA  NA  NA                          NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA                                                rbcL               \n2   NA  Brazil           Para                         rbcL matK       ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS\n1        rbcL---                               \n2 rbcL-matK--ITS                               \n```\n\n\n:::\n\n```{.r .cell-code}\ncombtab_split_barcodes <- strsplit(combtab$multi, \"-\")\nhead(combtab_split_barcodes, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n[1] \"rbcL\" \"\"     \"\"    \n\n[[2]]\n[1] \"rbcL\" \"matK\" \"\"     \"ITS\" \n```\n\n\n:::\n\n```{.r .cell-code}\nhead(unlist(combtab_split_barcodes)[which(unlist(combtab_split_barcodes)!=\"\")], 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rbcL\" \"rbcL\"\n```\n\n\n:::\n\n```{.r .cell-code}\nlength(which(unlist(combtab_split_barcodes)!=\"\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 372460\n```\n\n\n:::\n\n```{.r .cell-code}\n# Convert blank cells to NA\ncombtab[combtab == \"\"] <- NA\n\n# Count the number of barcodes per specimen\ncombtab$barcode_count <- rowSums(!is.na(combtab[, c(\"rbcL\", \"matK\", \"trnL\", \"ITS2\")]))\n\n# Calculate the total number of barcodes across all rows\ntotal_barcodes <- sum(combtab$barcode_count)\n\n# Display the results\n#View(combtab)\ntotal_barcodes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 373582\n```\n\n\n:::\n\n```{.r .cell-code}\n# write combtab\ncombtab <- combtab \nwrite.csv(combtab, \"../data/combtab.csv\")\n\n# write out combtab here for supplementary/supporting information \nlength(unique(combtab$species_name))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 102887\n```\n\n\n:::\n\n```{.r .cell-code}\nlength(unique(combtab$country))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 208\n```\n\n\n:::\n\n```{.r .cell-code}\nlength(unique(combtab$family_name))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 651\n```\n\n\n:::\n\n```{.r .cell-code}\nlength(unique(combtab$family_name))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 651\n```\n\n\n:::\n\n```{.r .cell-code}\n# calculate % north of tropic of cancer, south of tropic of capricorn, and between the two \ncombtab_north_of_tropic_of_cancer <- combtab %>% subset(lat > 23.4)\nhead(combtab_north_of_tropic_of_cancer, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    X.1   X   processid      institution_storing phylum_taxID   phylum_name\n106 152 152 GBVU4228-13 Mined from GenBank, NCBI           12 Magnoliophyta\n107 153 153 GBVX3812-15 Mined from GenBank, NCBI           12 Magnoliophyta\n    class_taxID    class_name order_taxID order_name family_taxID family_name\n106          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n107          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n    subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n106              NA           <NA>      554651 Clarkeasia        554652\n107              NA           <NA>      210661  Avicennia        641297\n             species_name subspecies_taxID subspecies_name collectiondate_start\n106 Clarkeasia parviflora               NA            <NA>                   NA\n107 Avicennia officinalis               NA            <NA>                   NA\n    collectiondate_end     lat     lon                      coord_source\n106                 NA 28.3009 84.1339 Coordinates from country centroid\n107                 NA 23.5863 81.1730 Coordinates from country centroid\n    coord_accuracy elev country province_state   region sector exactsite rbcL\n106             NA   NA   Nepal           <NA> Narayani   <NA>      <NA> rbcL\n107             NA   NA   India           <NA>     <NA>   <NA>      <NA> <NA>\n    matK trnL ITS2   multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count\n106 <NA> <NA> <NA> rbcL---    <NA>    <NA>    <NA>   <NA>             1\n107 matK <NA> <NA> -matK--    <NA>    <NA>    <NA>   <NA>             1\n```\n\n\n:::\n\n```{.r .cell-code}\ncombtab_south_of_tropic_of_capricorn <- combtab %>% subset(lat < -23.4)\nhead(combtab_south_of_tropic_of_capricorn, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid\n48  55 55 GBVU4382-13\n52  60 60  KNPA505-09\n                                                        institution_storing\n48                                                 Mined from GenBank, NCBI\n52 University of Johannesburg, Department of Botany and Plant Biotechnology\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n48           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n52           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n48       148533 Acanthaceae              NA           <NA>      554845\n52       148533 Acanthaceae              NA           <NA>      205058\n   genus_name species_taxID               species_name subspecies_taxID\n48 Petalidium        554846   Petalidium oblongifolium               NA\n52   Ruspolia        205059 Ruspolia hypocrateriformis               NA\n   subspecies_name collectiondate_start collectiondate_end      lat     lon\n48            <NA>                   NA                 NA -28.5536 24.7525\n52            <NA>                   NA                 NA -23.9440 31.7250\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n52                              <NA>             NA  208 South Africa\n   province_state region               sector\n48           <NA>   <NA>                 <NA>\n52        Limpopo   <NA> Kruger National Park\n                                            exactsite rbcL matK trnL ITS2\n48                                               <NA> rbcL <NA> <NA> <NA>\n52 Kruger National Park, Nxanatseni region  North,  L rbcL matK <NA> <NA>\n         multi  gb_rbcL  gb_matK gb_trnL gb_ITS barcode_count\n48     rbcL--- FJ868916     <NA>    <NA>   <NA>             1\n52 rbcL-matK-- KY632577 KY632577    <NA>   <NA>             2\n```\n\n\n:::\n\n```{.r .cell-code}\ncombtab_between_cancer_capricorn <- combtab %>% subset(lat >= -23.4 & lat <= 23.4)\nhead(combtab_between_cancer_capricorn, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n50  57 57 GENG1760-16 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n50          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n50          264310    Acanthoideae      148534    Ruellia            NA\n             species_name subspecies_taxID subspecies_name collectiondate_start\n49 Thunbergia grandiflora               NA            <NA>                   NA\n50                   <NA>               NA            <NA>                   NA\n   collectiondate_end    lat    lon    coord_source coord_accuracy elev country\n49                 NA 22.306 73.278 Garmin etrax 10             NA  130   India\n50                 NA 21.615 70.505            <NA>             NA  532   India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n49        Gujarat Vodadara   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n50        Gujarat Junagadh   <NA>     Etava rbcL <NA> <NA> <NA> rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count\n49 KX641599    <NA>    <NA>   <NA>             1\n50 KJ535203    <NA>    <NA>   <NA>             1\n```\n\n\n:::\n:::\n\n\n\n\n## Assess Project contibutions.\n\nThis block will assess the localized sampling projects' contributions to the overall BOLD database.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make container column \n# overall\nhead(combtab[grep(\"UHURU\", combtab$processid),], 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           <NA>      148750\n60       148533 Acanthaceae              NA           <NA>      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            <NA>                   NA                 NA 0.4810 36.8740\n60            <NA>                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         <NA>             NA 1650   Kenya    Rift Valley Laikipia   <NA>\n60         <NA>             NA 1650   Kenya    Rift Valley Laikipia   <NA>\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL <NA> rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL <NA> rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count\n59 KM255065   <NA>             3\n60 JX517979   <NA>             3\n```\n\n\n:::\n\n```{.r .cell-code}\ncombtab$container<-gsub(\"[0-9.-]\", \"\", combtab$processid)\nlength(unique(combtab$container))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 379\n```\n\n\n:::\n\n```{.r .cell-code}\nsort(table(combtab$container), decreasing=T) #PNG, YNPBP, UHURU\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nGBITS PGBMA  GBVX  GBVP   JWP  GBVA  GBVC  GBVU  GBVE  GBVS  GBVF  GBVW  GBVI \n70028 10890  8000  6694  6103  5270  4999  4989  4983  4983  4979  4959  4953 \n GBVM  GBVL  GBVG  GBVH  GBVK  GBVJ  GBVB  GBVD  GBVT  GBVR  SAFH  GBVO  GBVN \n 4939  4935  4920  4915  4898  4886  4870  4864  4854  4773  4271  3810  3668 \n GBVY BABRU POWNA  EBLF  GBVQ CPBOL  CRCZ   FCA  FBPL MHPAD   DPC   SDH UHURU \n 3629  3232  3174  3127  2863  2527  2450  2179  2143  2126  1780  1733  1720 \n GENG EDTOL  PNOR  KNPA VPSBC  FPUK PLOMA BRYCA IDRCG IPSUB TCAFR ABGCO MHPAF \n 1708  1581  1474  1339  1279  1240  1149  1125  1061   839   780   665   630 \nMKPCH  PLID CANGI GRASS   PNG SALIX YNPBP  BATT CALAK FSEUS GRDMO  AUSG MHPAC \n  622   590   564   553   551   540   527   520   508   502   498   479   448 \n  TRM MHPAA  TDEF  SCBI CANGA GCUDG PRTRE   KSR ALOAF   API FAUCT HOSAM   TSA \n  434   432   429   425   422   384   379   376   350   349   342   341   338 \n NNOR FPOON  KNPB  SBIO WABLK TRIOP   ALM ANGMD CSPPA VEMSH TMBRY NOVOA GRDTX \n  337   331   330   324   319   315   314   313   301   297   296   281   280 \n  FGB  PHAK GCUBG ITVPL APOSA PSYAF MXBZI TADCR CAATB   PIM POWNB CYPAF DBFZP \n  272   260   256   254   243   233   226   221   214   213   211   205   202 \nFYNBL   VPL RBTEP  FOND EGPAM MAPLT  PNCA HOLIN   POA BPTPS   ECU  ITVI MARQF \n  199   197   196   195   188   188   187   184   184   181   179   176   175 \nTRIKU BRYBC  CYAF IASVF HAIDA BBYUK  MADA    HB MXBTX BRALT  SERC   CPL  CPPB \n  175   174   173   172   170   164   164   160   160   159   159   157   148 \nPEPER   SAA  PLGE  BPNP GPAGA  KPLA  CROT ENDEM COBIN UGEAB  WREP MKTRT  FLSH \n  147   143   142   140   138   137   135   135   127   122   120   119   117 \nMADPL BSCAT   RBG PLKEN CAREX MKCRA CONOP NECLE DBMPP SFFIP   YHT   LWT   WAG \n  111   108   100    99    94    93    92    92    91    89    89    87    85 \nSASCH CREUA LEDCL LTRBN ZERGT  SLNM  OSCH  RUPL ORPOL LOPHZ POEUA RBPLT VPSEA \n   84    83    83    83    83    82    81    81    79    78    78    78    76 \nPLCHA  CRBS PCABL BRPLT KIFNE PANFT PLTHU  BTAM  GRII MEXCO PLNOR VLUZH KIFRH \n   75    74    74    73    72    70    69    68    68    68    63    63    62 \n BFAA COBIM  DBZN MLTVP  MPIN PLCOC RINGV  AGOP PLALG   SAP   AGL ATRIP  FSSM \n   61    60    60    60    60    60    58    55    55    55    54    54    54 \nPIPER  CERF  BAMP MIPDG ZPLPP   CSU DVHTF  DIDA   INB  SIDA SWFRG BRYUM  DBHI \n   53    51    50    50    49    48    47    46    46    46    46    44    44 \n CGII  MSTH JSUIS  HERB  IMDB KBGPP  NTDB KUDZU MKSAL CACRB IHGTI ITVRT TCHDC \n   43    43    42    41    40    40    40    39    39    38    36    36    35 \nKIFMO   THY  TNAU BBIHP CINCH INDET  PDBA  DBTS FERNO  FMED  SYKO PLNIP FAGRB \n   34    34    34    33    32    31    31    30    29    29    29    28    27 \nPLNIA LCBAR CACMK FFFCC MELIA   MBB PLWEL CRCBS PGLLP ACBRC AGMCV KIFHE   ATG \n   27    26    25    24    23    22    22    21    21    20    20    19    18 \n  BMS FQAGM SMPRS  CRCB GTICO TFOAX CRCBT PCUBC RBGEV AGVMK BBOBC  USMF   SDP \n   18    18    18    17    17    15    14    14    14    13    13    13    12 \nCACTB ITICS KIFAT MKOXY STRBS THYME ITVGA MHPAB NELKE PLCHU  PLNB PLPAR  PTOC \n   11    11    11    11    11    11    10    10    10    10    10    10    10 \n UADY AGVRB FAGMK  HRUC IMMEX  PMRB SABIO BBOTP LIVCA   MCT PCCMN PLTOR SEQLD \n   10     9     9     9     9     9     9     8     8     8     8     8     8 \n SPBL AUCAS CABAR RHEUM VASCB ALSEU BSRUG  DBTB  PHSN PLLAM   RBJ ABCBF ACCCO \n    8     7     7     7     7     6     6     6     6     6     6     5     5 \n BEER BHEPS CBIHP  DRAC IIPSA  MAHA  MPNE  MTSS NPOAF  PLON QUNAM RSUJO  SSAA \n    5     5     5     5     5     5     5     5     5     5     5     5     5 \n  CBL CSPPB EMPWG  RICE   BUL COMPL   GRJ ITICZ MSHQU  MTAT PCYMX  RJAS  AMBC \n    4     4     4     4     3     3     3     3     3     3     3     3     2 \nBCBSL  DCCC   GYM  HIMS  HRBC  KFRI LGRAS ORIGV PLPET PLSUD SEEWI  STRM SUSHI \n    2     2     2     2     2     2     2     2     2     2     2     2     2 \n  AKD   APP   ASJ DBALT  DLFW DMCSI DRCLS EOCCF  GUTB   ISO LAARS LADEE LAHAR \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \nLAMSK MASMD MCAND MCBRT MCCAL MCGFB MCIII MCJNM MCMAN MCUII MCUKI MCVAD MCYMB \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \n PCGM PLBRU PLMUS PLREN SDCCF SIDBG  SLAT   SLX  SPAP  SPAR   SRB THIPP  TRNT \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \n  UMS   WKA \n    1     1 \n```\n\n\n:::\n\n```{.r .cell-code}\n# for trnL\nlength(unique(combtab$container[which(combtab$trnL==\"trnL\")]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 40\n```\n\n\n:::\n\n```{.r .cell-code}\nsort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T) #PNG, YNPBP, UHURU\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nUHURU BRYCA YNPBP   PNG TMBRY BRYBC  MADA BRALT HAIDA   YHT PANFT  DBZN KIFRH \n 1598  1125   502   496   296   174   164   159   144    89    70    60    51 \nEDTOL  MPIN  FOND BBIHP KIFMO SASCH  SAFH   SAA GTICO KIFAT SABIO IMMEX INDET \n   50    49    47    33    32    32    24    19    17    11     9     8     8 \nLIVCA   MCT MIPDG   LWT CBIHP   CBL EMPWG   TSA APOSA MKPCH  NNOR VASCB  FBPL \n    8     8     7     6     5     4     4     4     3     2     2     2     1 \nMKTRT \n    1 \n```\n\n\n:::\n\n```{.r .cell-code}\n# percent of trnL sequences originating from top 5\nsum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)[1:5])/sum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7545079\n```\n\n\n:::\n\n```{.r .cell-code}\n(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)[1:5])/sum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     UHURU      BRYCA      YNPBP        PNG      TMBRY \n0.30015026 0.21130729 0.09429001 0.09316304 0.05559730 \n```\n\n\n:::\n\n```{.r .cell-code}\n# number of specimen records mined from genbank \ncombtab_mined_from_genbank<- subset (combtab, institution_storing == \"Mined from GenBank, NCBI\")\nhead(combtab_mined_from_genbank, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1  X     processid      institution_storing phylum_taxID   phylum_name\n4  11 11 GBITS29777-21 Mined from GenBank, NCBI           12 Magnoliophyta\n5  12 12 GBITS29782-21 Mined from GenBank, NCBI           12 Magnoliophyta\n  class_taxID    class_name order_taxID order_name family_taxID family_name\n4          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n5          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n  subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n4              NA           <NA>      148601 Aphelandra        801590\n5              NA           <NA>      148601 Aphelandra       1100819\n            species_name subspecies_taxID subspecies_name collectiondate_start\n4      Aphelandra hylaea               NA            <NA>                   NA\n5 Aphelandra maximiliana               NA            <NA>                   NA\n  collectiondate_end lat lon coord_source coord_accuracy elev country\n4                 NA  NA  NA         <NA>             NA   NA    <NA>\n5                 NA  NA  NA         <NA>             NA   NA    <NA>\n  province_state region sector exactsite rbcL matK trnL ITS2  multi gb_rbcL\n4           <NA>   <NA>   <NA>      <NA> <NA> <NA> <NA>  ITS #NAME?    <NA>\n5           <NA>   <NA>   <NA>      <NA> <NA> <NA> <NA>  ITS #NAME?    <NA>\n  gb_matK gb_trnL gb_ITS barcode_count container\n4    <NA>    <NA>   <NA>             1     GBITS\n5    <NA>    <NA>   <NA>             1     GBITS\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of specimens in combtab identified to species\ncombtab_IDd_to_species <- subset(combtab, species_name != \"\")\nhead(combtab_IDd_to_species, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           <NA>      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            <NA>\n2        632816          Ruellia inflata               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         <NA>             NA\n2                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    <NA>           <NA>   <NA>   <NA>      <NA> rbcL <NA> <NA> <NA>\n2   NA  Brazil           Para   <NA>   <NA>      <NA> rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    <NA>    <NA>    <NA>   <NA>             1       API\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of sequences mined from genbank \ncombtab_mined_from_genbank<- subset (combtab, institution_storing == \"Mined from GenBank, NCBI\")\nhead(combtab_mined_from_genbank, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1  X     processid      institution_storing phylum_taxID   phylum_name\n4  11 11 GBITS29777-21 Mined from GenBank, NCBI           12 Magnoliophyta\n5  12 12 GBITS29782-21 Mined from GenBank, NCBI           12 Magnoliophyta\n  class_taxID    class_name order_taxID order_name family_taxID family_name\n4          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n5          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n  subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n4              NA           <NA>      148601 Aphelandra        801590\n5              NA           <NA>      148601 Aphelandra       1100819\n            species_name subspecies_taxID subspecies_name collectiondate_start\n4      Aphelandra hylaea               NA            <NA>                   NA\n5 Aphelandra maximiliana               NA            <NA>                   NA\n  collectiondate_end lat lon coord_source coord_accuracy elev country\n4                 NA  NA  NA         <NA>             NA   NA    <NA>\n5                 NA  NA  NA         <NA>             NA   NA    <NA>\n  province_state region sector exactsite rbcL matK trnL ITS2  multi gb_rbcL\n4           <NA>   <NA>   <NA>      <NA> <NA> <NA> <NA>  ITS #NAME?    <NA>\n5           <NA>   <NA>   <NA>      <NA> <NA> <NA> <NA>  ITS #NAME?    <NA>\n  gb_matK gb_trnL gb_ITS barcode_count container\n4    <NA>    <NA>   <NA>             1     GBITS\n5    <NA>    <NA>   <NA>             1     GBITS\n```\n\n\n:::\n\n```{.r .cell-code}\ncombtab_mined_from_genbank[combtab_mined_from_genbank == \"\"] <- NA # Convert blank cells to NA\ncombtab_mined_from_genbank$barcode_count_mined <- rowSums(!is.na(combtab_mined_from_genbank[, c(\"rbcL\", \"matK\", \"trnL\", \"ITS2\")])) # Count the number of barcodes per specimen\ntotal_barcodes_mined <- sum(combtab_mined_from_genbank$barcode_count_mined) # Calculate the total number of barcodes across all rows\n#View(combtab_mined_from_genbank)\ntotal_barcodes_mined\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 199591\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of specimens in combtab with rbcL barcode \ncombtab_rbcL_barcodes <- subset(combtab, rbcL != \"\")\nhead(combtab_rbcL_barcodes, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           <NA>      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            <NA>\n2        632816          Ruellia inflata               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         <NA>             NA\n2                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    <NA>           <NA>   <NA>   <NA>      <NA> rbcL <NA> <NA> <NA>\n2   NA  Brazil           Para   <NA>   <NA>      <NA> rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    <NA>    <NA>    <NA>   <NA>             1       API\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of specimens in combtab with matK barcode \ncombtab_matK_barcodes <- subset(combtab, matK != \"\")\nhead(combtab_matK_barcodes, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           <NA>     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            <NA>\n3       1142732 Phlogacanthus colaniae               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         <NA>             NA\n3                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          <NA>   <NA>\n3  220   China        Guangxi Chongzuo City   <NA>\n                                           exactsite rbcL matK trnL ITS2\n2                                               <NA> rbcL matK <NA>  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n3 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3      EBLF\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of specimens in combtab with ITS barcode \ncombtab_ITS2_barcodes <- subset(combtab, ITS2 != \"\")\nhead(combtab_ITS2_barcodes, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           <NA>     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            <NA>\n3       1142732 Phlogacanthus colaniae               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         <NA>             NA\n3                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          <NA>   <NA>\n3  220   China        Guangxi Chongzuo City   <NA>\n                                           exactsite rbcL matK trnL ITS2\n2                                               <NA> rbcL matK <NA>  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n3 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3      EBLF\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of specimens in combtab with trnL barcode \ncombtab_trnL_barcodes <- subset(combtab, trnL != \"\")\nhead(combtab_trnL_barcodes, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           <NA>      148750\n60       148533 Acanthaceae              NA           <NA>      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            <NA>                   NA                 NA 0.4810 36.8740\n60            <NA>                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         <NA>             NA 1650   Kenya    Rift Valley Laikipia   <NA>\n60         <NA>             NA 1650   Kenya    Rift Valley Laikipia   <NA>\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL <NA> rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL <NA> rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   <NA>             3     UHURU\n60 JX517979   <NA>             3     UHURU\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of genbank accession numbers in combtab \ncombtab_for_genbank <- combtab\ncombtab_for_genbank[combtab_for_genbank == \"\"] <- NA # Convert blank cells to NA\n\n# Count the number of barcodes per specimen (number of non-NA values per row in the specified columns)\ncombtab_for_genbank$accession_count <- rowSums(!is.na(combtab_for_genbank[, c(\"gb_rbcL\", \"gb_matK\", \"gb_trnL\", \"gb_ITS\")]))\n\n# Calculate the total number of barcodes across all rows (sum of accession_count)\ntotal_accessions <- sum(combtab_for_genbank$accession_count)\n\n# Display the results\n#View(combtab_for_genbank)\ntotal_accessions\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 262920\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of specimens with country listed \ncombtab_countries <- subset(combtab, country != \"\")\nhead(combtab_countries, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           <NA>     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            <NA>\n3       1142732 Phlogacanthus colaniae               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         <NA>             NA\n3                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          <NA>   <NA>\n3  220   China        Guangxi Chongzuo City   <NA>\n                                           exactsite rbcL matK trnL ITS2\n2                                               <NA> rbcL matK <NA>  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n3 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3      EBLF\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of specimens with lat/long listed \ncombtab_lat <- subset(combtab, lat != \"\")\nhead(combtab_lat, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            <NA>      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            <NA>\n49   Thunbergia grandiflora               NA            <NA>\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           <NA>     <NA>   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n49        Gujarat Vodadara   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    <NA>    <NA>   <NA>             1      GBVU\n49 KX641599    <NA>    <NA>   <NA>             1      GENG\n```\n\n\n:::\n\n```{.r .cell-code}\ncombtab_lon <- subset(combtab, lon != \"\")\nhead(combtab_lon, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            <NA>      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            <NA>\n49   Thunbergia grandiflora               NA            <NA>\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           <NA>     <NA>   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n49        Gujarat Vodadara   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    <NA>    <NA>   <NA>             1      GBVU\n49 KX641599    <NA>    <NA>   <NA>             1      GENG\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of matK sequences\ncombtab_matK <- subset(combtab, matK == \"matK\")\nhead(combtab_matK, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           <NA>     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            <NA>\n3       1142732 Phlogacanthus colaniae               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         <NA>             NA\n3                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          <NA>   <NA>\n3  220   China        Guangxi Chongzuo City   <NA>\n                                           exactsite rbcL matK trnL ITS2\n2                                               <NA> rbcL matK <NA>  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n3 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3      EBLF\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of matK sequences with lat/long data \ncombtab_matK_latlong <- subset(combtab_matK, lat != \"\")\nhead(combtab_matK_latlong, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X  processid\n51  58 58 IMDB014-14\n52  60 60 KNPA505-09\n                                                        institution_storing\n51             Birla Institute of Technology - Pilani, K.K.Birla Goa Campus\n52 University of Johannesburg, Department of Botany and Plant Biotechnology\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n51           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n52           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n51       148533 Acanthaceae              NA           <NA>      390091\n52       148533 Acanthaceae              NA           <NA>      205058\n   genus_name species_taxID               species_name subspecies_taxID\n51   Acanthus        641300       Acanthus ilicifolius               NA\n52   Ruspolia        205059 Ruspolia hypocrateriformis               NA\n   subspecies_name collectiondate_start collectiondate_end      lat     lon\n51            <NA>                   NA                 NA  15.5256 73.8753\n52            <NA>                   NA                 NA -23.9440 31.7250\n   coord_source coord_accuracy elev      country province_state    region\n51         <NA>             NA   NA        India            Goa North Goa\n52         <NA>             NA  208 South Africa        Limpopo      <NA>\n                 sector                                          exactsite rbcL\n51      Mandovi estuary                                      Chorao Island rbcL\n52 Kruger National Park Kruger National Park, Nxanatseni region  North,  L rbcL\n   matK trnL ITS2       multi  gb_rbcL  gb_matK gb_trnL gb_ITS barcode_count\n51 matK <NA> <NA> rbcL-matK-- DQ028462 DQ028462    <NA>   <NA>             2\n52 matK <NA> <NA> rbcL-matK-- KY632577 KY632577    <NA>   <NA>             2\n   container\n51      IMDB\n52      KNPA\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of rbcL sequences\ncombtab_rbcL <- subset(combtab, rbcL == \"rbcL\")\nhead(combtab_rbcL, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           <NA>      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            <NA>\n2        632816          Ruellia inflata               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         <NA>             NA\n2                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    <NA>           <NA>   <NA>   <NA>      <NA> rbcL <NA> <NA> <NA>\n2   NA  Brazil           Para   <NA>   <NA>      <NA> rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    <NA>    <NA>    <NA>   <NA>             1       API\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of rbcL sequences with lat/long data \ncombtab_rbcL_latlong <- subset(combtab_rbcL, lat != \"\")\nhead(combtab_rbcL_latlong, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            <NA>      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            <NA>\n49   Thunbergia grandiflora               NA            <NA>\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           <NA>     <NA>   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n49        Gujarat Vodadara   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    <NA>    <NA>   <NA>             1      GBVU\n49 KX641599    <NA>    <NA>   <NA>             1      GENG\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of ITS sequences\ncombtab_ITS <- subset(combtab, ITS2 == \"ITS\")\nhead(combtab_ITS, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           <NA>     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            <NA>\n3       1142732 Phlogacanthus colaniae               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         <NA>             NA\n3                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          <NA>   <NA>\n3  220   China        Guangxi Chongzuo City   <NA>\n                                           exactsite rbcL matK trnL ITS2\n2                                               <NA> rbcL matK <NA>  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n3 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3      EBLF\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of ITS sequences with lat/long data \ncombtab_ITS_latlong <- subset(combtab_ITS, lat != \"\")\nhead(combtab_ITS_latlong, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X    processid             institution_storing phylum_taxID\n53  62 62 MHPAD3203-10 Area de Conservacion Guanacaste           12\n54  65 65  MHPAD537-09 Area de Conservacion Guanacaste           12\n     phylum_name class_taxID    class_name order_taxID order_name family_taxID\n53 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n54 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n   family_name subfamily_taxID subfamily_name genus_taxID genus_name\n53 Acanthaceae              NA           <NA>      148750   Justicia\n54 Acanthaceae              NA           <NA>      148750   Justicia\n   species_taxID        species_name subspecies_taxID subspecies_name\n53        317738   Justicia brenesii               NA            <NA>\n54        204815 Justicia arborecens               NA            <NA>\n   collectiondate_start collectiondate_end    lat     lon coord_source\n53                   NA                 NA 10.905 -85.279         <NA>\n54                   NA                 NA 10.923 -85.465         <NA>\n   coord_accuracy elev    country province_state\n53             NA  410 Costa Rica       Alajuela\n54             NA 1039 Costa Rica     Guanacaste\n                            region            sector\n53 Area de Conservacion Guanacaste Rincon Rainforest\n54 Area de Conservacion Guanacaste      Sector Cacao\n                                    exactsite rbcL matK trnL ITS2\n53                             Sendero Rincon rbcL matK <NA>  ITS\n54 Estacion Biologica Cacao, Sendero Arenales rbcL matK <NA>  ITS\n            multi  gb_rbcL  gb_matK gb_trnL   gb_ITS barcode_count container\n53 rbcL-matK--ITS AB114507 AB114507    <NA> AB114507             3     MHPAD\n54 rbcL-matK--ITS AF188127 AF188127    <NA> AF188127             3     MHPAD\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of trnL sequences\ncombtab_trnL <- subset(combtab, trnL == \"trnL\")\nhead(combtab_trnL, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           <NA>      148750\n60       148533 Acanthaceae              NA           <NA>      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            <NA>                   NA                 NA 0.4810 36.8740\n60            <NA>                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         <NA>             NA 1650   Kenya    Rift Valley Laikipia   <NA>\n60         <NA>             NA 1650   Kenya    Rift Valley Laikipia   <NA>\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL <NA> rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL <NA> rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   <NA>             3     UHURU\n60 JX517979   <NA>             3     UHURU\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of ITS sequences with lat/long data \ncombtab_trnL_latlong <- subset(combtab_trnL, lat != \"\")\nhead(combtab_trnL_latlong, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           <NA>      148750\n60       148533 Acanthaceae              NA           <NA>      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            <NA>                   NA                 NA 0.4810 36.8740\n60            <NA>                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         <NA>             NA 1650   Kenya    Rift Valley Laikipia   <NA>\n60         <NA>             NA 1650   Kenya    Rift Valley Laikipia   <NA>\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL <NA> rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL <NA> rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   <NA>             3     UHURU\n60 JX517979   <NA>             3     UHURU\n```\n\n\n:::\n\n```{.r .cell-code}\n# number of overall sequences with lat/long data \ncombtab_latlong <- subset(combtab, lat != \"\")\nhead(combtab_latlong, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            <NA>      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            <NA>\n49   Thunbergia grandiflora               NA            <NA>\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           <NA>     <NA>   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n49        Gujarat Vodadara   <NA>      <NA> rbcL <NA> <NA> <NA> rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    <NA>    <NA>   <NA>             1      GBVU\n49 KX641599    <NA>    <NA>   <NA>             1      GENG\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(combtab$trnL)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ntrnL \n5324 \n```\n\n\n:::\n\n```{.r .cell-code}\nlevels(factor(combtab$trnL))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"trnL\"\n```\n\n\n:::\n:::\n\n\n\n\n# Figure 1B-C. Plots for number of specimens across lat and lon for each barcode\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# round lat and lon to nearest one degree\nlatr <-round(combtab$lat)\n#latr\nlonr <- round(combtab$lon)\n#lonr\n\n# create rounded data frame \ncombtab_rounded <- combtab %>% dplyr::mutate(dplyr::across(c('lat', 'lon'), round, 0))\nhead(combtab_rounded, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           <NA>      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            <NA>\n2        632816          Ruellia inflata               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         <NA>             NA\n2                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    <NA>           <NA>   <NA>   <NA>      <NA> rbcL <NA> <NA> <NA>\n2   NA  Brazil           Para   <NA>   <NA>      <NA> rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    <NA>    <NA>    <NA>   <NA>             1       API\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n```\n\n\n:::\n\n```{.r .cell-code}\ncombtab_rounded_38 <- subset(combtab_rounded, lat == 38)\nhead(combtab_rounded_38, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      X.1    X   processid      institution_storing phylum_taxID   phylum_name\n366   507  507 GBVY3489-14 Mined from GenBank, NCBI           12 Magnoliophyta\n1312 2051 2051 GBVU4183-13 Mined from GenBank, NCBI           12 Magnoliophyta\n     class_taxID    class_name order_taxID order_name family_taxID family_name\n366           41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n1312          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n     subfamily_taxID  subfamily_name genus_taxID   genus_name species_taxID\n366           480072 Thunbergioideae      273749   Thunbergia        601895\n1312          264310    Acanthoideae      415904 Andrographis        415905\n                species_name subspecies_taxID subspecies_name\n366      Thunbergia coccinea               NA            <NA>\n1312 Andrographis paniculata               NA            <NA>\n     collectiondate_start collectiondate_end lat lon\n366                    NA                 NA  38 105\n1312                   NA                 NA  38 105\n                          coord_source coord_accuracy elev country\n366  Coordinates from country centroid             NA   NA   China\n1312 Coordinates from country centroid             NA   NA   China\n     province_state           region sector exactsite rbcL matK trnL ITS2\n366            <NA> Yunnan, Mengsong   <NA>      <NA> rbcL <NA> <NA> <NA>\n1312           <NA>             <NA>   <NA>      <NA> rbcL <NA> <NA> <NA>\n       multi  gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n366  rbcL--- KR737446    <NA>    <NA>   <NA>             1      GBVY\n1312 rbcL---     <NA>    <NA>    <NA>   <NA>             1      GBVU\n```\n\n\n:::\n\n```{.r .cell-code}\n# Plot longitude\nmarker_count_by_long_plot2 <- ggplot(combtab_rounded, aes(x = lon)) +\n  theme_classic() +\n  geom_bar(stat = \"count\", position = \"dodge\", fill = \"gray\") +\n  scale_x_continuous(breaks = seq(-180, 180, 60), limits = c(-180, 180)) + scale_y_continuous(breaks = seq(0, 5000, 1000), limits = c(0, 5000)) +\n geom_line(data = subset(combtab_rounded, matK == \"matK\"), aes(x = lon), stat = \"count\", col = \"#62BAAC\", lwd = 0.4) +\n  geom_line(data = subset(combtab_rounded, rbcL == \"rbcL\"), aes(x = lon), stat = \"count\", col = \"#EDA247\", lwd = 0.4) +\n  geom_line(data = subset(combtab_rounded, trnL == \"trnL\"), aes(x = lon), stat = \"count\", col = \"#006B5F\", lwd = 0.4) +\n  geom_line(data = subset(combtab_rounded, ITS2 == \"ITS\"), aes(x = lon), stat = \"count\", col = \"#703900\", lwd = 0.4) +\n  ylab(\"\") + xlab(\"\") #+ theme(panel.background = element_blank(), axis.text = element_blank())\nmarker_count_by_long_plot2\n```\n\n::: {.cell-output-display}\n![](geocov_figs1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#ggsave(\"marker_count_by_long_plot2_20240624.pdf\", marker_count_by_long_plot2, width = 13, height = 5, unit = \"cm\")\n\n# Plot latitude\nmarker_count_by_lat_plot_alllines <- ggplot() +\n  theme_classic() +\n  scale_x_continuous(breaks = seq(-90, 90, 45), limits = c(-90, 90)) +  scale_y_continuous(breaks = seq(0, 5500, 2500), limits = c(0, 5500)) +\n  geom_area(data = combtab_rounded, aes(x = lat), stat = \"count\", fill = \"lightgray\", lwd = 0.4) + \n  geom_line(data = subset(combtab_rounded, matK == \"matK\"), aes(x = lat), stat = \"count\", col = \"#62BAAC\", lwd = 0.4) +\n  geom_line(data = subset(combtab_rounded, rbcL == \"rbcL\"), aes(x = lat), stat = \"count\", col = \"#EDA247\", lwd = 0.4) +\n  geom_line(data = subset(combtab_rounded, trnL == \"trnL\"), aes(x = lat), stat = \"count\", col = \"#006B5F\", lwd = 0.4)+ \n  geom_line(data = subset(combtab_rounded, ITS2 == \"ITS\"), aes(x = lat), stat = \"count\", col = \"#703900\", lwd = 0.4)+ \n  ylab(\"\") + xlab(\"\") + theme(panel.background = element_blank(), axis.text = element_blank())\nmarker_count_by_lat_plot_alllines\n```\n\n::: {.cell-output-display}\n![](geocov_figs1_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#ggsave(\"marker_count_by_lat_plot_alllines_20240626_2.pdf\", marker_count_by_lat_plot_alllines, width = 8.6, height = 5, unit = \"cm\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncombtab_matK <- sum(combtab$matK == \"matK\")\ncombtab_rbcL <- combtab %>% subset(rbcL == \"rbcL\")\nhead(combtab_rbcL, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           <NA>      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            <NA>\n2        632816          Ruellia inflata               NA            <NA>\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         <NA>             NA\n2                   NA                 NA  NA  NA         <NA>             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    <NA>           <NA>   <NA>   <NA>      <NA> rbcL <NA> <NA> <NA>\n2   NA  Brazil           Para   <NA>   <NA>      <NA> rbcL matK <NA>  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    <NA>    <NA>    <NA>   <NA>             1       API\n2 rbcL-matK--ITS    <NA>    <NA>    <NA>   <NA>             3     CANGI\n```\n\n\n:::\n\n```{.r .cell-code}\nmatK <- subset(combtab_rounded, matK == \"matK\") \nrbcL <- subset(combtab_rounded, rbcL == \"rbcL\") \ntrnL <- subset(combtab_rounded, trnL == \"trnL\") \nITS <- subset(combtab_rounded, ITS2 == \"ITS\") \n```\n:::\n\n\n\n\n# Figure 1D. Plot MAT and MAP points with 95% confidence intervals\n\nTo run this next section, you'll need to download temperature and precipitation data from \\[Worldclim\\](\"[https://www.worldclim.org/data/worldclim21.html](https://www.worldclim.org/data/index.html)). Download both the `tavg 10m` and `prec 10m` datasets, unzip, and add to your `./data` folder at the root of the `MolEco-MEC-24-1288` repository [@worldclim_data].\\\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#####\n# Worldclim connect lat lon specimen records (rounded to nearest degree and dereplicated) with temperature and precip\n#####\n# dereplicate sites rounded to nearest degree\nsitepix<-cbind(lonr, latr)\nsitepix<-unique(sitepix)\n\n# load worldclim data\n\t# use 10 min for testing download directly from worldclim\nt.mean.files <- list.files(\"../data/wc2.1_10m_tavg/\", \".tif\", full.names=TRUE)\np.mean.files <- list.files(\"../data/wc2.1_10m_prec/\", \".tif\", full.names=TRUE)\n\n# temperature (using the raster package)\nt.mean <- stack(t.mean.files)\nt.mean <-mean(t.mean)\n\n# make a 'samples' data frame to extract temp values from barcode localities\nsamples <- data.frame(processid=seq(1,nrow(sitepix)), lon=sitepix[,1], lat=sitepix[,2], row.names=\"processid\")\nhead(samples, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  lon lat\n1  NA  NA\n2  25 -29\n```\n\n\n:::\n\n```{.r .cell-code}\nsamples <- samples[which(samples$lat!=\"NA\"),]\nhead(samples, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  lon lat\n2  25 -29\n3  73  22\n```\n\n\n:::\n\n```{.r .cell-code}\n# Extract data from RasterLayer\ntemp.data <- raster::extract(t.mean, samples)\nhead(temp.data, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 17.8276 27.2780\n```\n\n\n:::\n\n```{.r .cell-code}\nsampletempMeans <- temp.data\nlength(which(is.na(sampletempMeans))) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 393\n```\n\n\n:::\n\n```{.r .cell-code}\n# precipitation\np.mean <- stack(p.mean.files)\np.mean <-sum(p.mean)/10 \t# divide by 10 to convert from mm to cm\n\n# Extract data from RasterLayer\nprecip.data <- raster::extract(p.mean, samples)\nhead(precip.data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  43.6  88.5  53.2 414.5  54.9 275.5\n```\n\n\n:::\n\n```{.r .cell-code}\nsampleprecipMeans <- precip.data\nlength(which(is.na(sampleprecipMeans))) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 393\n```\n\n\n:::\n\n```{.r .cell-code}\n# plot Figure 1d\n# get random points to plot as background\nset.seed(20140816)\nnrand<-100000\n\nrandomtemp <- sampleRandom(mean(t.mean), nrand, xy=T)\nrandomprecip <- extract(mean(p.mean), randomtemp[,1:2])\n\nrandomtempMeans <- randomtemp[,3]\nrandomprecipMeans <- randomprecip\nrandompoints <- cbind(randomtempMeans, randomprecipMeans)\n\n# find the upper / lower 95 percentile for temp and precip to plot based on BOLD samples\ntemp95 <- quantile(sampletempMeans, c(0.05), na.rm=T)\nprecip95 <- quantile(sampleprecipMeans, c(0.95), na.rm=T) \n\n# Plot figure 1D\nplot(randomprecipMeans ~ randomtempMeans, xlim=rev(range(randomtempMeans, na.rm=T)), pch=16, col=\"gray\", ylab=\"Mean annual precipitation (cm)\", xlab=\"mean annual temperature (C)\", type=\"n\", ylim=c(0, max(c(max(randomprecipMeans), max(sampleprecipMeans, na.rm=T)))))\n\tpointcols<-rep(\"gray\", nrand)\n\tpointcols[which(randompoints[,1]<=temp95)]<-\"darkblue\"\n\tpointcols[which(randompoints[,2]>=precip95)]<-\"darkgreen\"\n\tpointcols[which(randompoints[, 1] <= temp95 & randompoints[, 2] >= precip95)] <- \"orange\"\npoints(randompoints[,1], randompoints[,2], pch=16, col= pointcols)\npoints(x=sampletempMeans, y=sampleprecipMeans, pch=3, col=alpha(\"black\", 0.2))\nabline(h=precip95, v=temp95, lty=2, col=\"black\", lwd=2)\n```\n\n::: {.cell-output-display}\n![](geocov_figs1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n# Figure 1A. Map: Geography of plant barcodes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# map for places inside or outside climate envelopes\n# make raster by thresholds\nthreshtemp <- t.mean\nvalues(threshtemp) <- as.numeric(values(threshtemp<as.numeric(temp95)))\n\nquantile(values(p.mean), na.rm=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    0%    25%    50%    75%   100% \n   0.0   11.0   33.8   68.7 1119.1 \n```\n\n\n:::\n\n```{.r .cell-code}\nthreshprecip <- p.mean\nvalues(threshprecip) <- as.numeric(values(threshprecip>as.numeric(precip95)))\nclass(threshprecip)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"RasterLayer\"\nattr(,\"package\")\n[1] \"raster\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# create ggplot-usable world map \nworld <- sf::st_as_sf(map(\"world\", plot = FALSE, fill = TRUE))\n\n# transform all features to longlat and WGS84 - first, world\nst_crs(world)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: +proj=longlat +ellps=clrk66 +no_defs +type=crs \n  wkt:\nGEOGCRS[\"unknown\",\n    DATUM[\"Unknown based on Clarke 1866 ellipsoid\",\n        ELLIPSOID[\"Clarke 1866\",6378206.4,294.978698213898,\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]]\n```\n\n\n:::\n\n```{.r .cell-code}\nworld <- st_transform(world,CRS(\"+proj=longlat +datum=WGS84\")) # the goal here is to choose a projection and datum that every spatial object we add to the map will be converted to before plotting\nst_crs(world) # check coordinate system to ensure projection worked\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: GEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]] \n  wkt:\nGEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]]\n```\n\n\n:::\n\n```{.r .cell-code}\nworld <- fortify(world) # re-examine features\nclass(world)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sf\"         \"data.frame\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# transform all features to longlat and WGS84 - next, threshtemp\nst_crs(threshtemp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: +proj=longlat +datum=WGS84 +no_defs \n  wkt:\nGEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]]\n```\n\n\n:::\n\n```{.r .cell-code}\nnewthreshtemp <- \" +proj=longlat +datum=WGS84\"\n# simplest approach\nthreshtemp <- projectRaster(threshtemp, crs=newthreshtemp)\nst_crs(threshtemp) # check coordinate system to ensure projection worked\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: +proj=longlat +datum=WGS84 +no_defs \n  wkt:\nGEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]]\n```\n\n\n:::\n\n```{.r .cell-code}\nthreshtemp #re-examine features\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass      : RasterLayer \ndimensions : 1078, 2156, 2324168  (nrow, ncol, ncell)\nresolution : 0.167, 0.167  (x, y)\nextent     : -180, 180.052, -90.026, 90  (xmin, xmax, ymin, ymax)\ncrs        : +proj=longlat +datum=WGS84 +no_defs \nsource     : memory\nnames      : layer \nvalues     : 0, 1  (min, max)\n```\n\n\n:::\n\n```{.r .cell-code}\n# transform all features to longlat and WGS84 - next, threshprecip\nst_crs(threshprecip)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: +proj=longlat +datum=WGS84 +no_defs \n  wkt:\nGEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]]\n```\n\n\n:::\n\n```{.r .cell-code}\nnewthreshprecip <- \" +proj=longlat +datum=WGS84\"\n# simplest approach\nthreshprecip <- projectRaster(threshprecip, crs=newthreshprecip)\nst_crs(threshprecip) # check coordinate system to ensure projection worked\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: +proj=longlat +datum=WGS84 +no_defs \n  wkt:\nGEOGCRS[\"unknown\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]],\n        ID[\"EPSG\",6326]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433],\n        ID[\"EPSG\",8901]],\n    CS[ellipsoidal,2],\n        AXIS[\"longitude\",east,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]],\n        AXIS[\"latitude\",north,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433,\n                ID[\"EPSG\",9122]]]]\n```\n\n\n:::\n\n```{.r .cell-code}\nthreshprecip # re-examine features\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass      : RasterLayer \ndimensions : 1078, 2156, 2324168  (nrow, ncol, ncell)\nresolution : 0.167, 0.167  (x, y)\nextent     : -180, 180.052, -90.026, 90  (xmin, xmax, ymin, ymax)\ncrs        : +proj=longlat +datum=WGS84 +no_defs \nsource     : memory\nnames      : layer \nvalues     : 0, 1  (min, max)\n```\n\n\n:::\n\n```{.r .cell-code}\n# Create a data frame for ggplot purposes - threshtemp\nthreshtemp_df <- as.data.frame(threshtemp, xy = TRUE, na.rm = TRUE)\nhead(threshtemp_df, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             x       y layer\n80618 -38.8015 83.7375     0\n80619 -38.6345 83.7375     0\n```\n\n\n:::\n\n```{.r .cell-code}\nthreshtemp_df_subset <- subset(threshtemp_df, layer > 0)\n\n# Create a data frame for ggplot purposes - threshprecip\nthreshprecip_df <- as.data.frame(threshprecip, xy = TRUE, na.rm = TRUE)\nhead(threshprecip_df, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             x       y layer\n80618 -38.8015 83.7375     0\n80619 -38.6345 83.7375     0\n```\n\n\n:::\n\n```{.r .cell-code}\nthreshprecip_df_subset <- subset(threshprecip_df, layer > 0 )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot geography of plant DNA barcodes\n#ggplot wrapper of map()\nworld_map <- map_data(\"world\") \n\nggmap4 <- ggplot()  + theme_classic() +\n geom_map(dat = world_map, map = world_map, aes(map_id = region), fill = \"white\", color = \"#7f7f7f\", size = 0.25)  +\n  geom_raster(data = threshtemp_df, aes(x = x, y = y, fill = layer), alpha = 0.9) + \n  scale_fill_gradient(low = \"transparent\", high = \"darkblue\", aesthetics = 'fill') + \n  annotate(geom=\"raster\", x=threshprecip_df_subset$x, y=threshprecip_df_subset$y, alpha=.9,\n           fill = scales::colour_ramp(c(\"transparent\",\"darkgreen\"))(threshprecip_df_subset$layer)) + geom_point(data = combtab, aes(x = lon, y = lat), pch = 3, size = 0.05, stroke = 0.25, color = alpha(\"darkgray\", 0.9)) + ylab(\"\") + xlab(\"\") + theme(legend.position = \"none\") +  scale_y_continuous(breaks=seq(-90,90,45), limits = c(-90, 90)) + scale_x_continuous(breaks=seq(-180,180,60), limits = c(-180, 180)) +  ylab(\"\") + xlab(\"\")+ theme(panel.background = element_blank(), axis.text = element_blank()) +\n  geom_hline(yintercept = 0, color = \"black\", size = 0.5) + # Equator line\n  geom_hline(yintercept = 23.5, linetype = \"dashed\", color = \"black\", size = 0.5) + # Tropic of Cancer\n  geom_hline(yintercept = -23.5, linetype = \"dashed\", color = \"black\", size = 0.5)  # Tropic of Capricorn\nggmap4\n```\n\n::: {.cell-output-display}\n![](geocov_figs1_files/figure-html/plot-geocov-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#ggsave(\"ggmap4_20240626_1.pdf\", ggmap4,  width = 13, height = 8.6, unit = \"cm\")\n```\n:::\n",
    "supporting": [
      "geocov_figs1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}