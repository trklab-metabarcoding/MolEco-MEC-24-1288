{
  "hash": "8a443bdf2157e0698f7ab7cb5ef1843b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Mapping global coverage from local sampling\"\nformat: html\nparams: \n  resolution: 3\n  random_sample_prop: 1 # between 0-1\n  random_sample_n: 1000\n---\n\n\n\n\n\n\n\n\nImport the records once the download is finished; this could take a while on a slow connection.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic() # starts a timer\nrecords <- occ_download_get('0066939-241126133413365') # generated in `Fetching plant occurrence records from GBIF`\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDownload file size: 1934.4 MB\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile exists & overwrite=FALSE, not overwriting...\n```\n\n\n:::\n\n```{.r .cell-code}\ndata <- occ_download_import(records, select=c(\"scientificName\",\"species\",\"taxonKey\", \"speciesKey\",\"year\",\"decimalLongitude\",\"decimalLatitude\",\"countryCode\"))\ntoc() # ends the timer\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n49.024 sec elapsed\n```\n\n\n:::\n\n```{.r .cell-code}\nbeep(2)\n```\n:::\n\n\n\n\nInspect the lat/long values.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"Longitude extremes:\", min(data$decimalLongitude), max(data$decimalLongitude))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLongitude extremes: -179.9753 179.9876\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"Latitude extremes:\", min(data$decimalLatitude), max(data$decimalLatitude))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLatitude extremes: -55.04704 85.75\n```\n\n\n:::\n:::\n\n\n\n\nFilter out points at the edges of flat map, they are causes some stretching issues when building hex bins.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata2 <- data %>%\n  filter(between(decimalLatitude, -85, 85)) %>%\n  filter(between(decimalLongitude, -175, 175))\n```\n:::\n\n\n\n\n## Convert 18.5 Mil records into H3 hex shapes\n\nWe use the Uber H3 hexagon system for binning records into spatial areas to plot densities.\n\n### Convert df to sf\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_sf <- st_as_sf(x = data2,                         \n           coords = c(\"decimalLongitude\", \"decimalLatitude\"),\n           crs = 4326)\n```\n:::\n\n\n\n\n### Check \\# of species vs \\# of scientific name\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(length(unique(data_sf$scientificName)), length(unique(data_sf$species)), length(unique(data_sf$taxonKey)), length(unique(data_sf$speciesKey)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n3941 311 3941 311\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nspecies <- as.data.frame(unique(data_sf$species))\nspecies\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          unique(data_sf$species)\n1                  Holcus lanatus\n2                Senecio vulgaris\n3            Hypochaeris radicata\n4            Achillea millefolium\n5            Agrostis stolonifera\n6              Juncus articulatus\n7               Prunella vulgaris\n8      Chamaenerion angustifolium\n9           Deschampsia cespitosa\n10              Spergularia rubra\n11               Trifolium repens\n12               Ranunculus acris\n13          Ranunculus sceleratus\n14          Eleocharis acicularis\n15                  Festuca rubra\n16           Phalaris arundinacea\n17                Phleum pratense\n18                  Sonchus asper\n19           Eleocharis palustris\n20                  Poa pratensis\n21                   Rubus idaeus\n22               Sonchus arvensis\n23          Potamogeton gramineus\n24              Cerastium arvense\n25                Carex canescens\n26                 Galium boreale\n27             Juniperus communis\n28              Tragopogon dubius\n29                Bromus tectorum\n30                 Erigeron acris\n31                Thlaspi arvense\n32         Campanula rotundifolia\n33            Onopordum acanthium\n34             Limosella aquatica\n35          Asparagus officinalis\n36             Veronica peregrina\n37             Koeleria macrantha\n38                  Poa palustris\n39               Dianthus armeria\n40            Solidago canadensis\n41             Alyssum alyssoides\n42            Lepidium virginicum\n43               Myosurus minimus\n44           Allium schoenoprasum\n45                Euphorbia esula\n46              Chondrilla juncea\n47                 Bromus inermis\n48           Potentilla norvegica\n49            Xanthium strumarium\n50                Agrostis scabra\n51                   Carex limosa\n52                     Poa alpina\n53                 Phleum alpinum\n54             Astragalus alpinus\n55             Myosotis alpestris\n56              Eritrichium nanum\n57            Potentilla argentea\n58                Alyssum simplex\n59                  Oxyria digyna\n60              Sagina saginoides\n61            Anthoxanthum nitens\n62              Bromus squarrosus\n63            Dasiphora fruticosa\n64            Persicaria amphibia\n65                   Viola adunca\n66           Collinsia parviflora\n67               Agrostis exarata\n68            Lepidium appelianum\n69            Erythranthe lewisii\n70       Ranunculus eschscholtzii\n71          Hesperochiron pumilus\n72          Maianthemum racemosum\n73                   Actaea rubra\n74       Lithophragma parviflorum\n75                   Acer glabrum\n76           Aconitum columbianum\n77           Taraxacum officinale\n78            Populus tremuloides\n79            Fragaria virginiana\n80             Iris missouriensis\n81           Aquilegia flavescens\n82              Sedum lanceolatum\n83                 Mahonia repens\n84        Polemonium pulcherrimum\n85       Ceratocephala orthoceras\n86       Spiranthes romanzoffiana\n87           Ranunculus uncinatus\n88             Veronica americana\n89                 Allium cernuum\n90           Platanthera dilatata\n91        Ranunculus alismifolius\n92                 Elymus glaucus\n93                Viola nuttallii\n94                Neottia cordata\n95              Wyethia sagittata\n96                  Linum lewisii\n97         Geranium viscosissimum\n98               Carex duriuscula\n99            Agropyron cristatum\n100              Phlox longifolia\n101            Lysimachia ciliata\n102              Bromus japonicus\n103        Sporobolus cryptandrus\n104             Festuca octoflora\n105                Elymus smithii\n106             Danthonia spicata\n107          Sphaeralcea coccinea\n108          Equisetum laevigatum\n109             Tamarix chinensis\n110              Bromus carinatus\n111              Elymus elymoides\n112           Hesperostipa comata\n113             Plantago elongata\n114        Polygonum ramosissimum\n115       Castilleja linariifolia\n116             Glyceria borealis\n117      Calamagrostis canadensis\n118         Geranium richardsonii\n119       Pseudoroegneria spicata\n120         Schoenoplectus acutus\n121              Boechera stricta\n122           Camelina microcarpa\n123               Hordeum jubatum\n124           Gayophytum diffusum\n125           Potentilla hippiana\n126           Polygonum douglasii\n127         Eleocharis rostellata\n128          Torreyochloa pallida\n129             Collomia linearis\n130              Elymus violaceus\n131                Pinus contorta\n132                Rumex fueginus\n133  Schoenoplectus subterminalis\n134        Androsace occidentalis\n135            Descurainia incana\n136       Delphinium nuttallianum\n137          Eriogonum umbellatum\n138     Androsace septentrionalis\n139                Carex obtusata\n140          Senecio triangularis\n141         Beckmannia syzigachne\n142      Taraxacum erythrospermum\n143                    Poa glauca\n144              Koeleria spicata\n145        Taraxacum ceratophorum\n146                Phlox gracilis\n147         Scolochloa festucacea\n148               Salvia nemorosa\n149             Anemone multifida\n150     Deschampsia danthonioides\n151                   Poa secunda\n152          Penstemon fruticosus\n153                  Packera cana\n154           Potentilla gordonii\n155               Carex vallicola\n156         Veronica wormskjoldii\n157        Delphinium occidentale\n158      Symphyotrichum ascendens\n159             Lupinus argenteus\n160   Leptosiphon septentrionalis\n161       Puccinellia nuttalliana\n162   Symphyotrichum bracteolatum\n163          Erigeron caespitosus\n164          Helianthus nuttallii\n165            Carex pachystachya\n166      Symphyotrichum foliaceum\n167                Geum triflorum\n168             Oxytropis sericea\n169                Carex simulata\n170             Mertensia ciliata\n171          Festuca brachyphylla\n172            Eremogone congesta\n173             Penstemon deustus\n174             Rumex paucifolius\n175         Helianthella uniflora\n176              Astragalus miser\n177        Eriogonum heracleoides\n178          Tetradymia canescens\n179                  Carex rossii\n180             Carex brunnescens\n181            Erigeron glabellus\n182        Calochortus eurycarpus\n183           Astragalus agrestis\n184                Carex petasata\n185                  Poa cusickii\n186          Lomatium triternatum\n187       Chenopodiastrum simplex\n188        Polemonium occidentale\n189         Castilleja rhexifolia\n190                Carex disperma\n191              Erigeron pumilus\n192        Antennaria microphylla\n193               Agoseris glauca\n194       Scrophularia lanceolata\n195            Castilleja miniata\n196        Plagiobothrys scouleri\n197            Astragalus purshii\n198            Taraxia subacaulis\n199              Stenotus acaulis\n200          Eremopyrum triticeum\n201          Boechera retrofracta\n202               Leymus cinereus\n203         Micranthes rhomboidea\n204              Phlox multiflora\n205          Eriocoma lettermanii\n206         Alyssum turkestanicum\n207          Cherleria obtusiloba\n208             Senecio crassulus\n209            Carex chalciolepis\n210               Carex elynoides\n211         Clematis hirsutissima\n212           Heterotheca villosa\n213                     Poa arida\n214               Draba albertina\n215        Polygonum polygaloides\n216          Lomatium macrocarpum\n217             Iliamna rivularis\n218            Carex praegracilis\n219                Draba nemorosa\n220          Danthonia intermedia\n221          Penstemon attenuatus\n222             Castilleja pilosa\n223            Festuca idahoensis\n224            Penstemon procerus\n225               Veronica biloba\n226         Epilobium hornemannii\n227             Myosurus apetalus\n228             Draba oligosperma\n229                  Poa interior\n230             Crepis modocensis\n231            Orthocarpus luteus\n232   Drymocallis pseudorupestris\n233      Toxicoscordion venenosum\n234              Eriogonum flavum\n235              Carex raynoldsii\n236          Erigeron ochroleucus\n237             Draba crassifolia\n238             Penstemon cyaneus\n239              Elymus scribneri\n240             Carex spectabilis\n241        Chenopodium atrovirens\n242         Saxifraga bronchialis\n243         Solidago multiradiata\n244                   Poa reflexa\n245         Eriogonum caespitosum\n246       Stephanomeria runcinata\n247               Carex filifolia\n248             Geum macrophyllum\n249     Muhlenbergia richardsonis\n250                Festuca kingii\n251          Castilleja pulchella\n252    Calamagrostis purpurascens\n253           Erigeron corymbosus\n254       Thalictrum sparsiflorum\n255        Thalictrum occidentale\n256         Epilobium lactiflorum\n257                Glyceria elata\n258                Carex parryana\n259         Oreocarya spiculifera\n260      Fritillaria atropurpurea\n261               Lactuca biennis\n262            Allium brevistylum\n263             Boechera lemmonii\n264        Muhlenbergia glomerata\n265                 Draba globosa\n266                 Poa leptocoma\n267         Wyethia helianthoides\n268              Carex haydeniana\n269                Carex paysonis\n270          Claytonia multiscapa\n271              Opuntia fragilis\n272             Carex leporinella\n273               Ionactis alpina\n274             Eriocoma nelsonii\n275      Symphyotrichum campestre\n276                  Carex hoodii\n277            Taraxia breviflora\n278              Carex neurophora\n279             Arabis pycnocarpa\n280           Ceanothus velutinus\n281           Parnassia fimbriata\n282                 Silene parryi\n283           Heuchera cylindrica\n284              Dryas octopetala\n285        Scheuchzeria palustris\n286        Synthyris wyomingensis\n287      Telesonix heucheriformis\n288           Heuchera parviflora\n289                    Draba cana\n290         Calamagrostis stricta\n291            Polygonum achoreum\n292                 Draba incerta\n293               Carex tahoensis\n294               Ventenata dubia\n295 Pedicularis cystopteridifolia\n296       Castilleja crista-galli\n297        Conimitella williamsii\n298                Bromus porteri\n299           Hieracium praealtum\n300               Filago arvensis\n301          Matricaria discoidea\n302           Blitum nuttallianum\n303               Koeleria vaseyi\n304                Draba praealta\n305              Arabis nuttallii\n306             Mimulus moschatus\n307             Physaria reediana\n308         Eriocoma richardsonii\n309              Carex stenoptila\n310         Ranunculus mongolicus\n311              Castilleja nivea\n```\n\n\n:::\n:::\n\n\n\n\nGet CRS info.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nraster::crs(data_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"GEOGCRS[\\\"WGS 84\\\",\\n    ENSEMBLE[\\\"World Geodetic System 1984 ensemble\\\",\\n        MEMBER[\\\"World Geodetic System 1984 (Transit)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G730)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G873)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1150)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1674)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1762)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G2139)\\\"],\\n        ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        ENSEMBLEACCURACY[2.0]],\\n    PRIMEM[\\\"Greenwich\\\",0,\\n        ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    CS[ellipsoidal,2],\\n        AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n            ORDER[1],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n            ORDER[2],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    USAGE[\\n        SCOPE[\\\"Horizontal component of 3D system.\\\"],\\n        AREA[\\\"World.\\\"],\\n        BBOX[-90,-180,90,180]],\\n    ID[\\\"EPSG\\\",4326]]\"\n```\n\n\n:::\n:::\n\n\n\n\nThis step pairs lat long into a point geometry.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_transform(data_sf, 4326)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 20503896 features and 6 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -174.9518 ymin: -55.04704 xmax: 175 ymax: 84.75\nGeodetic CRS:  WGS 84\n# A tibble: 20,503,896 × 7\n   scientificName          species         taxonKey speciesKey  year countryCode\n * <chr>                   <chr>              <int>      <int> <int> <chr>      \n 1 Holcus lanatus L.       Holcus lanatus   2706164    2706164  2018 FR         \n 2 Holcus lanatus L.       Holcus lanatus   2706164    2706164  2018 FR         \n 3 Senecio vulgaris L.     Senecio vulgar…  3108983    3108983  1985 FR         \n 4 Hypochaeris radicata L. Hypochaeris ra…  3093702    3093702  2019 FR         \n 5 Achillea millefolium L. Achillea mille…  3120060    3120060  2015 FR         \n 6 Agrostis stolonifera L. Agrostis stolo…  2706435    2706435  1994 FR         \n 7 Achillea millefolium L. Achillea mille…  3120060    3120060  2000 FR         \n 8 Senecio vulgaris L.     Senecio vulgar…  3108983    3108983  2009 FR         \n 9 Juncus articulatus L.   Juncus articul…  2701261    2701261  1991 FR         \n10 Prunella vulgaris L.    Prunella vulga…  5341297    5341297  1999 FR         \n# ℹ 20,503,886 more rows\n# ℹ 1 more variable: geometry <POINT [°]>\n```\n\n\n:::\n:::\n\n\n\n\nToss records without a species assigned and randomly subsample per species.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_sf <- data_sf %>%\n  filter(species != \"\") %>%\n  group_by(species) %>%\n  #slice_sample(n = params$random_sample_n) # number of samples\n  slice_sample(prop = params$random_sample_prop) # proportion of samples\n```\n:::\n\n\n\n\nMake a point for the centroid of YNP (middle of Yellowstone Lake), to use for distance calculations.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nYNP_centroid <- st_point(c(-110.40, 44.45)) %>%\n  st_coordinates() %>%\n  as.data.frame() %>%\n  st_as_sf(coords = c(\"X\", \"Y\"), crs = 4326)\n\nusa = st_as_sf(map('state', plot = FALSE, fill = TRUE))\n\nggplot() + \n  geom_sf(data = usa) +\n  geom_sf(data = YNP_centroid, aes(geometry=geometry), pch = 19, color = 'darkturquoise')\n```\n\n::: {.cell-output-display}\n![](build_geocov_map_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n\nThis block will calculate the distances from the center of Yellowstone for each row in the dataset.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\n data_sf <- data_sf %>%\n  mutate(\n    dist = st_distance(geometry, YNP_centroid) %>%\n  set_units(\"km\"))\nbeep(2)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n91.123 sec elapsed\n```\n\n\n:::\n:::\n\n\n\n\n### Summarize the distances to get a count, average distance, and sd of distance for each species.\n\nThis will output a dataframe where each row in one of the 279 species with occurrence records in GBIF. The geometries are also merged to a multipoint so a minimum convex polygon for a single species could be plotted easily.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nspecies_dist <- data_sf %>%\n  group_by(species) %>%\n  summarise(\n    count = n(),\n    min_dist = min(dist),\n    max_dist = max(dist),\n    mean_dist = mean(dist),\n    sd_dist = sd(dist)\n  )\nbeep(2)\nsummary(species_dist)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   species              count            min_dist           max_dist    \n Length:311         Min.   :     26   Min.   :   1.268   Min.   :  174  \n Class :character   1st Qu.:   1083   1st Qu.:  12.825   1st Qu.: 3099  \n Mode  :character   Median :   3751   Median :  31.953   Median : 8666  \n                    Mean   :  65929   Mean   :  61.950   Mean   : 8562  \n                    3rd Qu.:  15874   3rd Qu.:  53.920   3rd Qu.:12698  \n                    Max.   :1392917   Max.   :5688.516   Max.   :19489  \n   mean_dist         sd_dist                 geometry  \n Min.   : 108.5   Min.   :  30.38   MULTIPOINT   :311  \n 1st Qu.: 710.5   1st Qu.: 328.71   epsg:4326    :  0  \n Median :1068.3   Median : 786.85   +proj=long...:  0  \n Mean   :2889.7   Mean   :1124.93                      \n 3rd Qu.:6019.3   3rd Qu.:1576.01                      \n Max.   :8737.6   Max.   :5122.90                      \n```\n\n\n:::\n\n```{.r .cell-code}\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n628.331 sec elapsed\n```\n\n\n:::\n:::\n\n\n\n\nOutput a file with summary data about distances!\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspecies_dist %>%\n  st_drop_geometry() %>%\n  write.csv(\"./distance_from_YNP_by_species.csv\")\n```\n:::\n\n\n\n\nUse this to get a few CRS codes to try for projection if things look off.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuggest_crs(data_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 6\n   crs_code crs_name                        crs_type crs_gcs crs_units crs_proj4\n   <chr>    <chr>                           <chr>      <dbl> <chr>     <chr>    \n 1 6931     WGS 84 / NSIDC EASE-Grid 2.0 N… project…    4326 m         +proj=la…\n 2 3395     WGS 84 / World Mercator         project…    4326 m         +proj=me…\n 3 3857     WGS 84 / Pseudo-Mercator        project…    4326 m         +proj=me…\n 4 6933     WGS 84 / NSIDC EASE-Grid 2.0 G… project…    4326 m         +proj=ce…\n 5 3832     WGS 84 / PDC Mercator           project…    4326 m         +proj=me…\n 6 6932     WGS 84 / NSIDC EASE-Grid 2.0 S… project…    4326 m         +proj=la…\n 7 8903     RGWF96 / UTM zone 1S            project…    8900 m         +proj=ut…\n 8 3576     WGS 84 / North Pole LAEA Russia project…    4326 m         +proj=la…\n 9 3575     WGS 84 / North Pole LAEA Europe project…    4326 m         +proj=la…\n10 3574     WGS 84 / North Pole LAEA Atlan… project…    4326 m         +proj=la…\n```\n\n\n:::\n:::\n\n\n\n\nPull geospatial hex locations for each point set.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_sf$h3_index <- geo_to_h3(data_sf, params$resolution) \n```\n:::\n\n\n\n\nGroup by hex bin and count species in each one.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check that the number of unique bins is much less than the number of rows\nlength(unique(data_sf$h3_index))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7426\n```\n\n\n:::\n\n```{.r .cell-code}\ndata_sf2 <- data_sf %>%\n  group_by(h3_index) %>%\n  summarise(distinct_species = n_distinct(species))\nbeep(2)\n```\n:::\n\n\n\n\nCount the number of records in each hex bin.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_freq <- as.data.frame(table(data_sf2$h3_index))\n```\n:::\n\n\n\n\nGet the coordinates of of each hex bin.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_hex <- h3_to_geo_boundary_sf(data_sf2$h3_index)\n```\n:::\n\n\n\n\nMerge the bin coords with frequency data for plotting.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_data <- merge(as.data.frame(data_sf2), data_hex, by=\"h3_index\")\n```\n:::\n\n\n\n\nReport out the number of hexagons, and the min and max number of species in any one hex.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(length(unique(plot_data$h3_index)), min(plot_data$distinct_species), max(plot_data$distinct_species))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n7426 1 276\n```\n\n\n:::\n:::\n\n\n\n\nBuild the map\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nworldmap <- ne_countries(scale = 'large', returnclass = 'sf')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_sf(data = worldmap$geometry) +\n  geom_sf(data = plot_data, aes(geometry = geometry.y, fill=distinct_species)) +\n  scale_fill_viridis_c(option=\"turbo\") +\n  ggtitle(\"Count of species in each cell\") +\n  theme_classic() + theme(legend.title = element_blank()) \n```\n\n::: {.cell-output-display}\n![](build_geocov_map_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"BOLD_GBIF_12400km2.png\") # uncomment to save a copy\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSaving 7 x 5 in image\n```\n\n\n:::\n:::\n",
    "supporting": [
      "build_geocov_map_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}